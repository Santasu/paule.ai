<!DOCTYPE html>
<html lang="lt" data-theme="light" data-backend="vercel">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Paule ‚Äì Premium AI Chat</title>
  <link rel="stylesheet" href="/assets/css/paule.css">

  <!-- üîß PAULE konfig≈´racija (VERCEL re≈æimas: /api/* mar≈°rutai) -->
  <script id="paule-config">
    (function () {
      var htmlAttr = (document.documentElement.getAttribute('data-backend') || '').trim().toLowerCase();
      var MODE = htmlAttr === 'vercel' ? 'vercel' : 'wp'; // paliekam jungiklƒØ, bet default m≈´s≈≥ atveju "vercel"

      // üëâ Plok≈°ƒçias API be /paule/v1
      var restBase = MODE === 'vercel' ? '/api' : '/wp-json/paule/v1';

      var routes = {
        base: restBase,
        stream:        restBase + '/stream',            // GET (SSE) | POST (mode=once)
        models:        restBase + '/models',
        diagnostics:   restBase + '/diagnostics',

        // vaizdai
        comicCreate:   restBase + '/comic/create',      // alias ƒØ flux
        fluxCreate:    restBase + '/flux/create',
        triptych:      restBase + '/image/triptych-series',

        // (jei ateity darysi personas/projektus ‚Äî palikau kaip rezervƒÖ)
        personaCreate: restBase + '/persona/create',
        personaList:   restBase + '/persona/list',
        personaSeries: restBase + '/persona/generate_series',

        // muzika
        musicCreate:   restBase + '/music/create',
        musicStatus:   restBase + '/music/status',      // ?task=...
        musicCallback: restBase + '/music/callback',

        // runway
        runwayImage:   restBase + '/runway/image',
        runwayStatus:  restBase + '/runway/status',     // ?task_id=...
        runwayVideoUpscale:         restBase + '/runway/video-upscale',
        runwayCharacterPerformance: restBase + '/runway/character-performance',
        runwayVideoToVideo:         restBase + '/runway/video-to-video',
        runwayImageToVideo:         restBase + '/runway/image-to-video',
        runwayTextVideo:            restBase + '/runway/text-video',
        runwayTextVideoPipeline:    restBase + '/runway/text-video-pipeline',
        runwayPipelineStatus:       restBase + '/runway/pipeline-status', // ?pipeline_id=...
        runwayPing:                 restBase + '/runway/ping'
      };

      var CFG = {
        mode: MODE,                      // 'wp' | 'vercel'
        restBase: routes.base,
        restStream: routes.stream,
        // kai kurie klientai naudoja /stream-sse ‚Äì ƒçia leid≈æiam suderinamumƒÖ
        restStreamSSE: routes.stream + '?mode=sse',
        sseDefault: 1,

        pluginBase:   '/assets',
        iconsBase:    '/assets/icon',
        featuresBase: '/assets/features',

        routes: routes,
        version: 'paule-1.0.1'
      };

      window.PAULE_CONFIG = CFG;
      window.AUGAM_CONFIG = CFG; // legacy suderinamumas

      try {
        Object.defineProperty(window, 'API_BASE', {
          configurable: true,
          get: function(){ return CFG.restBase; },
          set: function(_){} // ignoruojam
        });
      } catch(e) {}
      window.__SET_API_BASE__ = function (v) { /* jei reikƒót≈≥ vƒóliau keisti */ };
    })();
  </script>

  <!-- ‚úÖ PAULE bridge: jei kur nors dar liko /augam/v1 ar /paule/v1, perra≈°om ƒØ /api -->
  <script id="paule-bridge">
    (function(){
      'use strict';
      try {
        var restBase = (window.PAULE_CONFIG && window.PAULE_CONFIG.restBase) || '/api';

        // EventSource
        if (window.EventSource) {
          var OrigES = window.EventSource;
          window.EventSource = function(url, opts){
            try {
              url = String(url)
                .replace(/\/wp-json\/(?:augam|paule)\/v1(\/|$)/, '/api$1')
                .replace(/\/(?:augam|paule)\/v1(\/|$)/, '/api$1');
            } catch(_){}
            return new OrigES(url, opts);
          };
          window.EventSource.prototype = OrigES.prototype;
        }
        // fetch
        if (window.fetch) {
          var origFetch = window.fetch;
          window.fetch = function(input, init){
            try {
              var u = (typeof input === 'string') ? input : (input && input.url);
              if (u) {
                var nu = String(u)
                  .replace(/\/wp-json\/(?:augam|paule)\/v1(\/|$)/, '/api$1')
                  .replace(/\/(?:augam|paule)\/v1(\/|$)/, '/api$1');
                if (nu !== u) {
                  if (typeof input === 'string') { input = nu; }
                  else { input = new Request(nu, input); }
                }
              }
            } catch(_){}
            return origFetch(input, init);
          };
        }

        window.__FORCE_STREAM_ENDPOINT__ = restBase.replace(/\/+$/,'') + '/stream';
      } catch(e) { console.warn('[PAULE bridge] warning:', e); }
    })();
  </script>
</head>
<body>

  <!-- Mobilus overlay (JS tikisi #mobileOverlay) -->
  <div id="mobileOverlay" class="mobile-overlay" style="display:none;"></div>

  <!-- ===== TOPBAR ===== -->
  <header class="topbar" data-no-clip="true">
    <a class="brand" href="/" aria-label="Paule">
      <img id="brandLogo" class="brand-icon" src="/assets/icon/paule-logo.webp" alt="paule">
    </a>

    <!-- Modeli≈≥ juosta (JS ie≈°ko #modelList) -->
    <nav class="models-in-topbar" aria-label="Modeliai" id="modelList">
      <button class="model-pill active" data-model="augam-auto" aria-pressed="true">
        <img class="ui-icon" src="/assets/icon/ai-auto.svg" alt=""> Auto
      </button>
      <button class="model-pill" data-model="chatgpt">
        <img class="ui-icon" src="/assets/icon/chatgpt.svg" alt=""> ChatGPT
      </button>
      <button class="model-pill" data-model="claude">
        <img class="ui-icon" src="/assets/icon/claude-seeklogo.svg" alt=""> Claude
      </button>
      <button class="model-pill" data-model="gemini">
        <img class="ui-icon" src="/assets/icon/gemini.svg" alt=""> Gemini
      </button>
      <button class="model-pill" data-model="grok">
        <img class="ui-icon" src="/assets/icon/xAI.svg" alt=""> Grok
      </button>
      <button class="model-pill" data-model="deepseek">
        <img class="ui-icon" src="/assets/icon/deepseek.svg" alt=""> DeepSeek
      </button>
      <button class="model-pill" data-model="llama">
        <img class="ui-icon" src="/assets/icon/llama.svg" alt=""> Llama
      </button>
    </nav>

    <div class="top-actions">
      <a class="btn ghost" href="/community" role="button">
        <img class="ui-icon" src="/assets/icon/nav-results.svg" alt=""> Bendruomenƒó
      </a>
      <button class="btn ghost" id="btnNewChat">
        <img class="ui-icon" src="/assets/icon/nav-new-chat.svg" alt=""> Naujas pokalbis
      </button>

      <button class="btn ghost mobile-toggle" id="btnMobile" aria-label="Meniu (mobilus)">
        <img class="ui-icon" src="/assets/icon/nav-menu.svg" alt=""> Meniu
      </button>

      <!-- Kai prisijungta -->
      <div class="user-profile hidden" id="userProfile">
        <div class="user-avatar" id="userAvatar">U</div>
        <div class="user-name" id="userName">Vartotojas</div>
        <div class="profile-dropdown" id="profileDropdown">
          <div class="dropdown-item" style="cursor:default">
            <img class="ui-icon" src="/assets/icon/nav-theme.svg" alt="">
            <div class="profile-controls">
              <select class="select" id="selTheme" aria-label="Tema">
                <option value="light">≈†viesi</option>
                <option value="dark">Tamsi</option>
              </select>
              <select class="select" id="selLang" aria-label="Kalba">
                <option value="lt">LT</option>
                <option value="en">EN</option>
              </select>
            </div>
          </div>

          <div class="dropdown-item" style="cursor:default; flex-direction:column; align-items:flex-start;">
            <div class="mini-title">Statistika</div>
            <div class="stats-grid">
              <div class="stat-chip"><span><img class="ui-icon" src="/assets/icon/chatgpt.svg" alt=""> GPT</span><span class="stat-count">87% (42)</span></div>
              <div class="stat-chip"><span><img class="ui-icon" src="/assets/icon/claude-seeklogo.svg" alt=""> Claude</span><span class="stat-count">92% (38)</span></div>
              <div class="stat-chip"><span><img class="ui-icon" src="/assets/icon/deepseek.svg" alt=""> DeepSeek</span><span class="stat-count">78% (25)</span></div>
              <div class="stat-chip"><span><img class="ui-icon" src="/assets/icon/xAI.svg" alt=""> Grok</span><span class="stat-count">83% (19)</span></div>
              <div class="stat-chip"><span><img class="ui-icon" src="/assets/icon/llama.svg" alt=""> Llama</span><span class="stat-count">95% (51)</span></div>
              <div class="stat-chip"><span><img class="ui-icon" src="/assets/icon/gemini.svg" alt=""> Gemini</span><span class="stat-count">89% (34)</span></div>
            </div>
          </div>

          <div class="dropdown-item" data-action="logout">
            <img class="ui-icon" src="/assets/icon/logout.svg" alt=""> Atsijungti
          </div>
        </div>
      </div>

      <!-- Prisijungti ‚Äì CSS popup (#loginModalOverlay) -->
      <a class="btn ghost" id="btnLogin" href="#loginModalOverlay" role="button">
        <img class="ui-icon" src="/assets/icon/user.svg" alt=""> Prisijungti
      </a>
    </div>
  </header>

  <!-- ===== LAYOUT ===== -->
  <div class="layout">
    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar" id="sidebar">
      <!-- AI specialistai -->
      <section class="side-section">
        <div class="side-title">AI specialistai</div>
        <div class="specialist-grid" id="specialistGrid">
          <a class="chip" href="#spec-sefas" data-route="/spec/sefas" data-spec="sefas"><img class="ui-icon" src="/assets/icon/chef-knife.svg" alt=""> ≈†efas</a>
          <a class="chip" href="#spec-marketing" data-route="/spec/marketing" data-spec="marketing"><img class="ui-icon" src="/assets/icon/marketing-megaphone.svg" alt=""> Marketing</a>
          <a class="chip" href="#spec-pardavimai" data-route="/spec/pardavimai" data-spec="pardavimai"><img class="ui-icon" src="/assets/icon/sales-handshake.svg" alt=""> Pardavimai</a>
          <a class="chip" href="#spec-verslas" data-route="/spec/verslas" data-spec="verslas"><img class="ui-icon" src="/assets/icon/business-strategy.svg" alt=""> Verslas</a>
          <a class="chip" href="#spec-finansai" data-route="/spec/finansai" data-spec="finansai"><img class="ui-icon" src="/assets/icon/finance-investment.svg" alt=""> Finansai</a>
          <a class="chip" href="#spec-keliones" data-route="/spec/keliones" data-spec="keliones"><img class="ui-icon" src="/assets/icon/travel-map.svg" alt=""> Kelionƒós</a>
          <a class="chip" href="#spec-renginiai" data-route="/spec/renginiai" data-spec="renginiai"><img class="ui-icon" src="/assets/icon/event-planning.svg" alt=""> Renginiai</a>
          <a class="chip" href="/spec/goal.html" data-route="/spec/goal.html" data-spec="goal"><img class="ui-icon" src="/assets/icon/tool-mindmap.svg" alt=""> Tiksl≈≥ ≈æemƒólapis</a>
          <a class="chip" href="#spec-teise" data-route="/spec/teisininkas" data-spec="teisininkas"><img class="ui-icon" src="/assets/icon/legal-contract.svg" alt=""> Teisininkas</a>
          <a class="chip" href="#spec-psichologas" data-route="/spec/psichologas" data-spec="psichologas"><img class="ui-icon" src="/assets/icon/psychology-brain.svg" alt=""> Psichologas</a>
        </div>
      </section>

      <!-- Aktyvumas -->
      <section class="side-section">
        <div class="side-title">Aktyvumas</div>
        <div class="community-pings" id="communityPings">
          <div class="ping"><img class="ui-icon" src="/assets/icon/music.svg" alt=""> @Mantas ƒØkƒólƒó dainƒÖ ‚ÄûVasaros vƒójas‚Äú</div>
          <div class="ping"><img class="ui-icon" src="/assets/icon/photo.svg" alt=""> @Ieva pridƒójo 3 nuotraukas</div>
          <div class="ping"><img class="ui-icon" src="/assets/icon/video-library.svg" alt=""> @Ruta publikavo ‚ÄûReklama-15s‚Äú</div>
        </div>
      </section>

      <!-- Mano biblioteka -->
      <section class="side-section">
        <div class="side-title"><a class="lib-link" href="/biblioteka#dainos">Dainos</a></div>
        <div class="library-grid">
          <a class="lib-card" href="/biblioteka#dainos"><img class="ui-icon" src="/assets/icon/music.svg" alt=""><span>‚ÄûVasaros vƒójas‚Äú</span></a>
          <a class="lib-card" href="/biblioteka#dainos"><img class="ui-icon" src="/assets/icon/music.svg" alt=""><span>‚ÄûNakties ≈°viesos‚Äú</span></a>
          <a class="lib-card" href="/biblioteka#dainos"><img class="ui-icon" src="/assets/icon/music.svg" alt=""><span>‚ÄûMiesto pulsas‚Äú</span></a>
        </div>
      </section>

      <section class="side-section">
        <div class="side-title"><a class="lib-link" href="/biblioteka#nuotraukos">Nuotraukos</a></div>
        <div class="library-grid">
          <a class="lib-card" href="/biblioteka#nuotraukos"><img class="ui-icon" src="/assets/icon/photo.svg" alt=""><span>Produktas</span></a>
          <a class="lib-card" href="/biblioteka#nuotraukos"><img class="ui-icon" src="/assets/icon/photo.svg" alt=""><span>Kampanija</span></a>
          <a class="lib-card" href="/biblioteka#nuotraukos"><img class="ui-icon" src="/assets/icon/photo.svg" alt=""><span>Vir≈°elis</span></a>
        </div>
      </section>

      <section class="side-section">
        <div class="side-title"><a class="lib-link" href="/biblioteka#video">Video</a></div>
        <div class="library-grid">
          <a class="lib-card" href="/biblioteka#video"><img class="ui-icon" src="/assets/icon/video-library.svg" alt=""><span>Reklama 15s</span></a>
          <a class="lib-card" href="/biblioteka#video"><img class="ui-icon" src="/assets/icon/video-library.svg" alt=""><span>Pristatymas</span></a>
          <a class="lib-card" href="/biblioteka#video"><img class="ui-icon" src="/assets/icon/video-library.svg" alt=""><span>U≈ækulisiai</span></a>
        </div>
      </section>

      <!-- Projektai -->
      <section class="side-section">
        <div class="side-title">Projektai</div>
        <div class="control-group" id="projectsList">
          <div class="project-item" data-project="new">
            <img class="ui-icon" src="/assets/icon/plus.svg" alt=""> Naujas projektas
          </div>
        </div>
      </section>

      <!-- Pokalbi≈≥ istorija -->
      <section class="side-section">
        <div class="side-title">Pokalbi≈≥ istorija</div>
        <div class="control-group" id="historyList"></div>
      </section>
    </aside>

    <!-- ===== MAIN ===== -->
    <main class="main">
      <div class="chat-area" id="chatArea">

        <!-- Hero -->
        <section class="welcome" id="welcome">
          <h1 class="hero-title">Sveiki atvykƒô ƒØ <span>paule</span></h1>
          <p>Pradƒókite naujƒÖ pokalbƒØ arba pasirinkite modelƒØ vir≈°uje.</p>

          <div class="welcome-actions">
            <a class="welcome-btn" href="#spec-sefas"><img class="ui-icon" src="/assets/icon/chef-healthy-bowl.svg" alt=""> Kulinarijos patarimai</a>
            <a class="welcome-btn" href="#spec-verslas"><img class="ui-icon" src="/assets/icon/business-finance.svg" alt=""> Verslo strategija</a>
            <a class="welcome-btn" href="/spec/goal.html"><img class="ui-icon" src="/assets/icon/tool-mindmap.svg" alt=""> Tiksl≈≥ ≈æemƒólapis</a>
          </div>

          <div class="community-strip">
            <div class="strip-item">Populiaru: ‚ÄûMiesto pulsas‚Äú ‚Ä¢ 2.1k</div>
            <div class="strip-item">Nauja: @Ieva ƒØkƒólƒó 3 nuotraukas</div>
            <div class="strip-item">Konkursas: Geriausia daina rugsƒójƒØ</div>
          </div>
        </section>

        <!-- Pavyzdinƒó ≈æinutƒó -->
        <article class="message">
          <div class="avatar"><img class="ui-icon" src="/assets/icon/ai.svg" alt=""></div>
          <div class="bubble" data-model="chatgpt">
            <div class="bubble-card">
              <div class="msg-content">
                Sveiki! Kuo galiu padƒóti? ƒåia atsiras atsakymai. ≈†is blokas riboto auk≈°ƒçio ir scrollinasi, kad nei≈°plƒóst≈≥ ekrano. ‚Ä¶ (turinys) ‚Ä¶
              </div>
              <div class="msg-meta">
                <span class="model-tag">ChatGPT</span>
              </div>
            </div>
          </div>
        </article>

      </div>
    </main>
  </div>

  <!-- ===== BOTTOM INPUT ===== -->
  <div class="bottom-section after-message" id="bottomSection" data-responsive="true">
    <div class="input-bar">
      <div class="input-container">
        <textarea class="message-input" id="messageInput" rows="1" placeholder="≈Ωinutƒó specialistui‚Ä¶"></textarea>
        <button class="send-btn" id="sendBtn" aria-label="Si≈≥sti">
          <img class="ui-icon" src="/assets/icon/arrow-top.svg" alt="">
        </button>
      </div>
    </div>

    <div class="tools-bar">
      <div class="tool" data-tool="mindmap"><img class="ui-icon" src="/assets/icon/tool-mindmap.svg" alt=""> Mindmap</div>
      <div class="tool" data-tool="photo"><img class="ui-icon" src="/assets/icon/tool-photo.svg" alt=""> Foto</div>
      <div class="tool" data-tool="file"><img class="ui-icon" src="/assets/icon/tool-file.svg" alt=""> Failas</div>
      <div class="tool" data-tool="song"><img class="ui-icon" src="/assets/icon/tool-music.svg" alt=""> Sukurti dainƒÖ</div>
      <div class="tool" data-tool="video"><img class="ui-icon" src="/assets/icon/video-plus.svg" alt=""> Sukurti video</div>
    </div>
  </div>

  <!-- ===== URL POPUP ‚Äì pavyzdys (≈°efas) ===== -->
  <section class="popup" id="spec-sefas" aria-modal="true" role="dialog">
    <div class="popup-body">
      <header class="popup-head">
        <h2><img class="ui-icon" src="/assets/icon/chef-knife.svg" alt=""> ≈†efas</h2>
        <a class="popup-close" href="#" aria-label="U≈ædaryti"><img class="ui-icon" src="/assets/icon/nav-close.svg" alt=""></a>
      </header>
      <div class="popup-content">
        ƒåia ‚Äì ≈°efui skirtas puslapis/popup. (Galima vƒóliau nukreipti ƒØ atskirƒÖ /spec/sefas.html.)
      </div>
    </div>
  </section>

  <!-- ===== AUTH popup (CSS-only) ===== -->
  <section class="popup" id="loginModalOverlay" aria-modal="true" role="dialog">
    <div class="popup-body">
      <header class="popup-head">
        <h2><img class="ui-icon" src="/assets/icon/user.svg" alt=""> Prisijungti</h2>
        <a class="popup-close" href="#" aria-label="U≈ædaryti" id="closeLoginModal"><img class="ui-icon" src="/assets/icon/nav-close.svg" alt=""></a>
      </header>
      <div class="popup-content" style="display:grid;gap:12px">
        <a class="btn" id="loginSubmitBtn" href="#"><img class="ui-icon" src="/assets/icon/nav-login.svg" alt=""> Prisijungti el. pa≈°tu</a>
        <a class="btn" id="googleLoginBtn" href="#"><img class="ui-icon" src="/assets/icon/google.svg" alt=""> Prisijungti su Google</a>

        <div class="mini-title">Tema ir kalba</div>
        <div style="display:flex;gap:8px">
          <select class="select" id="selThemeAuth" aria-label="Tema (modalas)">
            <option value="light">≈†viesi</option>
            <option value="dark">Tamsi</option>
          </select>
          <select class="select" aria-label="Kalba (modalas)">
            <option value="lt">LT</option>
            <option value="en">EN</option>
          </select>
        </div>
        <p style="color:#9aa0a8;font-size:12px">Pastaba: mygtukai demo re≈æimu ‚Äì backend prisijungimo nenaudojam.</p>
      </div>
    </div>
  </section>

  <!-- ===== Minimal JS (tema ‚Üî logotipas, mobilus meniu) ===== -->
  <script>
    (function(){
      const root = document.documentElement;
      const logo = document.getElementById('brandLogo');
      const sidebar = document.getElementById('sidebar');
      const btnMobile = document.getElementById('btnMobile');
      const selTheme = document.getElementById('selTheme');
      const selThemeAuth = document.getElementById('selThemeAuth');
      const mobileOverlay = document.getElementById('mobileOverlay');

      function updateLogo(){
        const isDark = (root.getAttribute('data-theme') === 'dark');
        logo.src = isDark ? '/assets/icon/paule-logo-b.svg' : '/assets/icon/paule-logo.webp';
      }
      updateLogo();

      selTheme && selTheme.addEventListener('change', (e)=>{
        root.setAttribute('data-theme', e.target.value); updateLogo();
      });
      selThemeAuth && selThemeAuth.addEventListener('change', (e)=>{
        root.setAttribute('data-theme', e.target.value); updateLogo();
      });

      btnMobile && btnMobile.addEventListener('click', ()=>{
        sidebar.classList.toggle('open');
        if (mobileOverlay) {
          const open = sidebar.classList.contains('open');
          mobileOverlay.style.display = open ? 'block' : 'none';
        }
      });
      mobileOverlay && mobileOverlay.addEventListener('click', ()=>{
        sidebar.classList.remove('open');
        mobileOverlay.style.display = 'none';
      });
    })();
  </script>

  <!-- Tavo programinƒó logika ‚Äì skaito window.PAULE_CONFIG -->
  <script src="/assets/js/paule-ui.js" defer></script>
</body>
</html>
