<!DOCTYPE html>
<html lang="lt" data-theme="light" data-backend="vercel">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Paule – Premium AI Chat</title>
  <link rel="stylesheet" href="/assets/css/paule.css">

  <!-- 🔧 PAULE konfigūracija -->
  <script>
    (function () {
      var MODE=(document.documentElement.getAttribute('data-backend')||'').trim().toLowerCase()==='vercel'?'vercel':'wp';
      var restBase = MODE==='vercel' ? '/api' : '/wp-json/paule/v1';
      var routes={ base:restBase, stream:restBase+'/stream', models:restBase+'/models',
        diagnostics:restBase+'/diagnostics', comicCreate:restBase+'/comic/create',
        fluxCreate:restBase+'/flux/create', triptych:restBase+'/image/triptych-series',
        personaCreate:restBase+'/persona/create', personaList:restBase+'/persona/list',
        personaSeries:restBase+'/persona/generate_series', musicCreate:restBase+'/music/create',
        musicStatus:restBase+'/music/status', musicCallback:restBase+'/music/callback',
        runwayImage:restBase+'/runway/image', runwayStatus:restBase+'/runway/status',
        runwayVideoUpscale:restBase+'/runway/video-upscale', runwayCharacterPerformance:restBase+'/runway/character-performance',
        runwayVideoToVideo:restBase+'/runway/video-to-video', runwayImageToVideo:restBase+'/runway/image-to-video',
        runwayTextVideo:restBase+'/runway/text-video', runwayTextVideoPipeline:restBase+'/runway/text-video-pipeline',
        runwayPipelineStatus:restBase+'/runway/pipeline-status', runwayPing:restBase+'/runway/ping'
      };
      var CFG={mode:MODE,restBase:routes.base,restStream:routes.stream,restStreamSSE:routes.stream,sseDefault:1,
        pluginBase:'/assets',iconsBase:'/assets/icon',featuresBase:'/assets/features',routes:routes,version:'paule-1.0.4'};
      window.PAULE_CONFIG=CFG; window.AUGAM_CONFIG=CFG;
      try{Object.defineProperty(window,'API_BASE',{configurable:true,get:function(){return CFG.restBase;},set:function(_){}});}catch(e){}
      window.__SET_API_BASE__=function(v){};
    })();
  </script>

  <!-- ✅ Bridge WP->/api -->
  <script>
    (function(){
      try{
        var restBase=(window.PAULE_CONFIG&&window.PAULE_CONFIG.restBase)||'/api';
        if(window.EventSource){
          var OrigES=window.EventSource;
          window.EventSource=function(url,opts){
            try{url=String(url).replace(/\/wp-json\/(?:augam|paule)\/v1(\/|$)/,'/api$1').replace(/\/(?:augam|paule)\/v1(\/|$)/,'/api$1');}catch(_){}
            return new OrigES(url,opts);
          };
          window.EventSource.prototype=OrigES.prototype;
        }
        if(window.fetch){
          var of=window.fetch;
          window.fetch=function(input,init){
            try{var u=(typeof input==='string')?input:(input&&input.url);
              if(u){var nu=String(u).replace(/\/wp-json\/(?:augam|paule)\/v1(\/|$)/,'/api$1').replace(/\/(?:augam|paule)\/v1(\/|$)/,'/api$1');
                if(nu!==u) input=(typeof input==='string')?nu:new Request(nu,input);
              }}catch(_){}
            return of(input,init);
          };
        }
        window.__FORCE_STREAM_ENDPOINT__=restBase.replace(/\/+$/,'')+'/stream';
      }catch(e){console.warn('[PAULE bridge] warning:',e);}
    })();
  </script>
</head>
<body>

  <!-- ===== TOPBAR ===== -->
  <header class="topbar" role="banner">
    <a class="brand" href="/" aria-label="Paule">
      <img id="brandLogo" class="brand-icon" src="/assets/icon/paule-logo.webp" alt="paule">
    </a>

    <!-- Modelių juosta -->
    <nav class="models-in-topbar" aria-label="Modeliai" id="modelList">
      <button class="model-pill active" data-model="auto" aria-pressed="true">
        <img class="ui-icon" src="/assets/icon/paule-icon.webp" alt=""> Paule
      </button>
      <button class="model-pill" data-model="chatgpt"><img class="ui-icon" src="/assets/icon/chatgpt.svg" alt=""> ChatGPT</button>
      <button class="model-pill" data-model="claude"><img class="ui-icon" src="/assets/icon/claude-seeklogo.svg" alt=""> Claude</button>
      <button class="model-pill" data-model="gemini"><img class="ui-icon" src="/assets/icon/gemini.svg" alt=""> Gemini</button>
      <button class="model-pill" data-model="grok"><img class="ui-icon" src="/assets/icon/xAI.svg" alt=""> Grok</button>
      <button class="model-pill" data-model="deepseek"><img class="ui-icon" src="/assets/icon/deepseek.svg" alt=""> DeepSeek</button>
      <button class="model-pill" data-model="llama"><img class="ui-icon" src="/assets/icon/llama.svg" alt=""> Llama</button>
    </nav>

    <!-- Dešinės pusės veiksmai -->
    <div class="top-actions">
      <a class="btn ghost" href="/community" role="button">
        <img class="ui-icon" src="/assets/icon/nav-results.svg" alt=""> Bendruomenė
      </a>
      <button class="btn ghost" id="btnNewChat">
        <img class="ui-icon" src="/assets/icon/nav-new-chat.svg" alt=""> Naujas pokalbis
      </button>

      <!-- Mobile: atidaro šoninį meniu -->
      <button class="btn ghost mobile-toggle" id="btnMobile" aria-label="Meniu (mobilus)">
        <img class="ui-icon" src="/assets/icon/nav-menu.svg" alt=""> Meniu
      </button>

      <!-- Tema (desktop) -->
      <div class="login-anchor hide-on-mobile">
        <button class="btn ghost" id="btnTheme"><img class="ui-icon" src="/assets/icon/nav-theme.svg" alt=""> Tema</button>
        <div class="login-dropdown" id="themeDropdown">
          <button class="btn" data-theme="light">Šviesi</button>
          <button class="btn" data-theme="dark">Tamsi</button>
        </div>
      </div>

      <!-- Prisijungimas – dropdown -->
      <div class="login-anchor">
        <button class="btn ghost" id="btnLogin">
          <img class="ui-icon" src="/assets/icon/user.svg" alt=""> Prisijungti
        </button>
        <div class="login-dropdown" id="loginDropdown">
          <a class="btn" id="googleLoginBtn" href="#"><img class="ui-icon" src="/assets/icon/google.svg" alt=""> Prisijungti su Google</a>
          <a class="btn" id="emailLoginBtn" href="#"><img class="ui-icon" src="/assets/icon/mail.svg" alt=""> Prisijungti el. paštu</a>
        </div>
      </div>
    </div>
  </header>

  <!-- ===== LAYOUT ===== -->
  <div class="layout">
    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar" id="sidebar">
      <!-- AI specialistai -->
      <section class="side-section">
        <div class="side-title">AI specialistai</div>
        <div class="specialist-grid" id="specialistGrid">
          <a class="chip" href="#spec-sefas" data-route="/spec/sefas" data-spec="sefas"><img class="ui-icon" src="/assets/icon/chef-knife.svg" alt=""> Šefas</a>
          <a class="chip" href="#spec-marketing" data-route="/spec/marketing" data-spec="marketing"><img class="ui-icon" src="/assets/icon/marketing-megaphone.svg" alt=""> Marketing</a>
          <a class="chip" href="#spec-pardavimai" data-route="/spec/pardavimai" data-spec="pardavimai"><img class="ui-icon" src="/assets/icon/sales-handshake.svg" alt=""> Pardavimai</a>
          <a class="chip" href="#spec-verslas" data-route="/spec/verslas" data-spec="verslas"><img class="ui-icon" src="/assets/icon/business-strategy.svg" alt=""> Verslas</a>
          <a class="chip" href="#spec-finansai" data-route="/spec/finansai" data-spec="finansai"><img class="ui-icon" src="/assets/icon/finance-investment.svg" alt=""> Finansai</a>
          <a class="chip" href="#spec-keliones" data-route="/spec/keliones" data-spec="keliones"><img class="ui-icon" src="/assets/icon/travel-map.svg" alt=""> Kelionės</a>
          <a class="chip" href="#spec-renginiai" data-route="/spec/renginiai" data-spec="renginiai"><img class="ui-icon" src="/assets/icon/event-planning.svg" alt=""> Renginiai</a>
          <a class="chip" href="/spec/goal.html" data-route="/spec/goal.html" data-spec="goal"><img class="ui-icon" src="/assets/icon/tool-mindmap.svg" alt=""> Tikslų žemėlapis</a>
          <a class="chip" href="#spec-teise" data-route="/spec/teisininkas" data-spec="teisininkas"><img class="ui-icon" src="/assets/icon/legal-contract.svg" alt=""> Teisininkas</a>
          <a class="chip" href="#spec-psichologas" data-route="/spec/psichologas" data-spec="psichologas"><img class="ui-icon" src="/assets/icon/psychology-brain.svg" alt=""> Psichologas</a>
        </div>
      </section>

      <!-- Aktyvumas -->
      <section class="side-section">
        <div class="side-title">Aktyvumas</div>
        <div class="community-pings" id="communityPings">
          <div class="ping"><img class="ui-icon" src="/assets/icon/music.svg" alt=""> @Mantas įkėlė dainą „Vasaros vėjas“</div>
          <div class="ping"><img class="ui-icon" src="/assets/icon/photo.svg" alt=""> @Ieva pridėjo 3 nuotraukas</div>
          <div class="ping"><img class="ui-icon" src="/assets/icon/video-library.svg" alt=""> @Ruta publikavo „Reklama-15s“</div>
        </div>
      </section>

      <!-- Bibliotekos miniatiūros (didesnės) -->
      <section class="side-section">
        <div class="side-title"><a class="lib-link" href="/biblioteka#dainos">Dainos</a></div>
        <div class="library-grid thumbs" id="songsFeed">
          <a class="lib-card thumb"><img src="/assets/hero/music.webp" alt=""><span>„Vasaros vėjas“</span></a>
          <a class="lib-card thumb"><img src="/assets/hero/music.webp" alt=""><span>„Nakties šviesos“</span></a>
          <a class="lib-card thumb"><img src="/assets/hero/music.webp" alt=""><span>„Miesto pulsas“</span></a>
        </div>
      </section>

      <section class="side-section">
        <div class="side-title"><a class="lib-link" href="/biblioteka#nuotraukos">Nuotraukos</a></div>
        <div class="library-grid thumbs" id="photosFeed">
          <a class="lib-card thumb"><img src="/assets/hero/photo.webp" alt=""><span>Produktas</span></a>
          <a class="lib-card thumb"><img src="/assets/hero/photo.webp" alt=""><span>Kampanija</span></a>
          <a class="lib-card thumb"><img src="/assets/hero/photo.webp" alt=""><span>Viršelis</span></a>
        </div>
      </section>

      <section class="side-section">
        <div class="side-title"><a class="lib-link" href="/biblioteka#video">Video</a></div>
        <div class="library-grid thumbs" id="videosFeed">
          <a class="lib-card thumb"><img src="/assets/hero/video.webp" alt=""><span>Reklama 15s</span></a>
          <a class="lib-card thumb"><img src="/assets/hero/video.webp" alt=""><span>Pristatymas</span></a>
          <a class="lib-card thumb"><img src="/assets/hero/video.webp" alt=""><span>Užkulisiai</span></a>
        </div>
      </section>

      <!-- Projektai -->
      <section class="side-section">
        <div class="side-title">Projektai</div>
        <div class="control-group" id="projectsList">
          <div class="project-item" data-project="new">
            <img class="ui-icon" src="/assets/icon/plus.svg" alt=""> Naujas projektas
          </div>
        </div>
      </section>

      <!-- Pokalbių istorija -->
      <section class="side-section">
        <div class="side-title">Pokalbių istorija</div>
        <div class="control-group" id="historyList"></div>
      </section>
    </aside>

    <!-- ===== MAIN ===== -->
    <main class="main">
      <div class="chat-area" id="chatArea">

        <!-- Sprendimų juosta -->
        <div id="decisionBar" class="decision-bar" style="display:none">
          <div class="decision-chip" data-mode="debate"><img class="ui-icon" src="/assets/icon/ai.svg" alt=""> AI ginčas</div>
          <div class="decision-chip" data-mode="judge"><img class="ui-icon" src="/assets/icon/legal-contract.svg" alt=""> Teisėjas</div>
          <div class="decision-chip" data-mode="compromise"><img class="ui-icon" src="/assets/icon/ai.svg" alt=""> Kompromisas</div>
        </div>

        <!-- Hero -->
        <section class="welcome" id="welcome">
          <h1 class="hero-title">KAIP GALIU PADĖTI ŠIANDIEN?</h1>
          <p>Pasirinkite AI specialistą kairėje arba pradėkite pokalbį žemiau. Viršuje galite rinktis vieną ar kelis modelius. 👇</p>

          <div class="welcome-grid">
            <a class="welcome-card" href="#" data-action="song">
              <img src="/assets/hero/music.webp" alt="">
              <b>Sukurti dainą</b><span>Pasveikink draugą unikalia gimtadienio daina.</span>
            </a>
            <a class="welcome-card" href="#" data-action="song-photo">
              <img src="/assets/hero/song-photo.webp" alt="">
              <b>Daina iš nuotraukos</b><span>Įkelk kadrą ir gauk originalią melodiją su žodžiais.</span>
            </a>
            <a class="welcome-card" href="#" data-action="photo">
              <img src="/assets/hero/photo.webp" alt="">
              <b>Sukurti nuotrauką</b><span>Produktai, scenos, peizažai, selfiai ir animacija.</span>
            </a>
            <a class="welcome-card" href="#" data-action="mindmap">
              <img src="/assets/hero/mindmap.webp" alt="">
              <b>Minčių žemėlapis</b><span>Susitelk į esmę ir didink produktyvumą.</span>
            </a>
            <a class="welcome-card" href="/spec/goal.html">
              <img src="/assets/hero/goals.webp" alt="">
              <b>Tikslų sistema (AI)</b><span>Vizija → užduotys → realūs rezultatai.</span>
            </a>
            <a class="welcome-card" href="#" data-action="video">
              <img src="/assets/hero/video.webp" alt="">
              <b>Sukurti video</b><span>Reels ir Stories iš teksto ar nuotraukų.</span>
            </a>
          </div>

          <div class="community-strip">
            <div class="strip-item">Populiaru: „Miesto pulsas“ • 2.1k</div>
            <div class="strip-item">Nauja: @Ieva įkėlė 3 nuotraukas</div>
            <div class="strip-item">Konkursas: Geriausia daina rugsėjį</div>
          </div>
        </section>

      </div>
    </main>
  </div>

  <!-- ===== BOTTOM INPUT ===== -->
  <div class="bottom-section after-message" id="bottomSection" data-responsive="true">
    <div class="input-bar">
      <div class="input-container">
        <textarea class="message-input" id="messageInput" rows="1" placeholder="Žinutė specialistui…"></textarea>
        <button class="send-btn" id="sendBtn" aria-label="Siųsti">
          <img class="ui-icon" src="/assets/icon/arrow-top.svg" alt="">
        </button>
      </div>
    </div>

    <div class="tools-bar">
      <div class="tool" data-tool="mindmap"><img class="ui-icon" src="/assets/icon/tool-mindmap.svg" alt=""> Mindmap</div>
      <div class="tool" data-tool="photo"><img class="ui-icon" src="/assets/icon/tool-photo.svg" alt=""> Foto</div>
      <div class="tool" data-tool="file"><img class="ui-icon" src="/assets/icon/tool-file.svg" alt=""> Failas</div>
      <div class="tool" data-tool="song"><img class="ui-icon" src="/assets/icon/tool-music.svg" alt=""> Sukurti dainą</div>
      <div class="tool" data-tool="video"><img class="ui-icon" src="/assets/icon/video-plus.svg" alt=""> Sukurti video</div>
      <div class="tool" data-tool="goals"><img class="ui-icon" src="/assets/icon/tool-mindmap.svg" alt=""> Tikslų sistema</div>
    </div>
  </div>

  <!-- ===== MOBILE SHEET (kairė meniu + bendruomenė + tema) ===== -->
  <div id="mobileBack" class="mobile-backdrop"></div>
  <aside id="mobileSheet" class="mobile-sheet" aria-hidden="true">
    <div class="sheet-body">
      <a class="sheet-tile" href="/community">
        <img class="ui-icon" src="/assets/icon/nav-results.svg" alt="">
        <span>Bendruomenė</span>
      </a>

      <div class="sheet-block">
        <div class="side-title">AI specialistai</div>
        <div class="specialist-grid">
          <a class="chip" href="#spec-sefas"><img class="ui-icon" src="/assets/icon/chef-knife.svg" alt=""> Šefas</a>
          <a class="chip" href="#spec-marketing"><img class="ui-icon" src="/assets/icon/marketing-megaphone.svg" alt=""> Marketing</a>
          <a class="chip" href="#spec-pardavimai"><img class="ui-icon" src="/assets/icon/sales-handshake.svg" alt=""> Pardavimai</a>
          <a class="chip" href="#spec-verslas"><img class="ui-icon" src="/assets/icon/business-strategy.svg" alt=""> Verslas</a>
          <a class="chip" href="#spec-finansai"><img class="ui-icon" src="/assets/icon/finance-investment.svg" alt=""> Finansai</a>
          <a class="chip" href="#spec-keliones"><img class="ui-icon" src="/assets/icon/travel-map.svg" alt=""> Kelionės</a>
          <a class="chip" href="#spec-renginiai"><img class="ui-icon" src="/assets/icon/event-planning.svg" alt=""> Renginiai</a>
          <a class="chip" href="/spec/goal.html"><img class="ui-icon" src="/assets/icon/tool-mindmap.svg" alt=""> Tikslų žemėlapis</a>
          <a class="chip" href="#spec-teise"><img class="ui-icon" src="/assets/icon/legal-contract.svg" alt=""> Teisininkas</a>
          <a class="chip" href="#spec-psichologas"><img class="ui-icon" src="/assets/icon/psychology-brain.svg" alt=""> Psichologas</a>
        </div>
      </div>

      <div class="sheet-block">
        <div class="side-title">Tema</div>
        <div class="sheet-row">
          <button class="btn" data-mobile-theme="light">Šviesi</button>
          <button class="btn" data-mobile-theme="dark">Tamsi</button>
        </div>
      </div>
    </div>
  </aside>

  <!-- Minimal JS (dropdown’ai, tema, mobile sheet, enter=send, logotipo swap) -->
  <script>
    (function(){
      const root=document.documentElement;
      const msgInput=document.getElementById('messageInput');
      const sendBtn=document.getElementById('sendBtn');
      const btnLogin=document.getElementById('btnLogin');
      const loginDropdown=document.getElementById('loginDropdown');
      const btnTheme=document.getElementById('btnTheme');
      const themeDropdown=document.getElementById('themeDropdown');
      const logo=document.getElementById('brandLogo');

      const btnMobile=document.getElementById('btnMobile');
      const mobileSheet=document.getElementById('mobileSheet');
      const mobileBack=document.getElementById('mobileBack');

      function refreshLogo(){
        const dark = root.getAttribute('data-theme') === 'dark';
        logo.src = dark ? '/assets/icon/paule-logo-dark.webp' : '/assets/icon/paule-logo.webp';
      }
      refreshLogo();

      // Tema (desktop)
      btnTheme?.addEventListener('click', (e)=>{ e.preventDefault(); themeDropdown?.classList.toggle('open'); loginDropdown?.classList.remove('open'); });
      themeDropdown?.addEventListener('click', (e)=>{
        const b=e.target.closest('[data-theme]'); if(!b) return;
        root.setAttribute('data-theme', b.getAttribute('data-theme'));
        refreshLogo();
        themeDropdown.classList.remove('open');
      });

      // Tema (mobile meniu)
      mobileSheet?.addEventListener('click',(e)=>{
        const t=e.target.closest('[data-mobile-theme]'); if(!t) return;
        root.setAttribute('data-theme', t.getAttribute('data-mobile-theme'));
        refreshLogo();
      });

      // Login dropdown
      btnLogin?.addEventListener('click', (e)=>{ e.preventDefault(); loginDropdown?.classList.toggle('open'); themeDropdown?.classList.remove('open'); });
      document.addEventListener('click', (e)=>{
        if(!e.target.closest('.login-anchor')){ loginDropdown?.classList.remove('open'); themeDropdown?.classList.remove('open'); }
      });

      // Enter → siųsti
      if(msgInput){
        msgInput.addEventListener('keydown', function(e){
          if (e.key==='Enter' && !e.shiftKey){
            e.preventDefault();
            if(window.sendMessage) window.sendMessage(); else sendBtn?.click();
          }
        });
      }

      // Mobile sheet
      function openSheet(){ mobileSheet.classList.add('open'); mobileBack.classList.add('open'); }
      function closeSheet(){ mobileSheet.classList.remove('open'); mobileBack.classList.remove('open'); }
      btnMobile?.addEventListener('click', openSheet);
      mobileBack?.addEventListener('click', closeSheet);

      // Hero įrankių sujungimas
      document.querySelectorAll('.welcome-grid .welcome-card')?.forEach(card=>{
        card.addEventListener('click', (e)=>{
          const a=card.getAttribute('data-action');
          e.preventDefault();
          document.querySelector(`.tool[data-tool="${a==='song-photo'?'song':a}"]`)?.click();
        });
      });
    })();
  </script>

  <!-- Pagrindinė logika (SSE ir t.t.) -->
  <script src="/assets/js/paule-ui.js" defer></script>
</body>
</html>
