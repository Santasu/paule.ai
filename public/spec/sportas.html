<!DOCTYPE html>
<html lang="lt" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FitAI Pro - Pilnavertė Fitness Platforma</title>
  
  <style>
/* =========================================================
   ULTRA DARK THEME
   ========================================================= */
:root {
  --bg-primary: #000000;
  --bg-secondary: #0a0a0a;
  --bg-elevated: #111111;
  --bg-card: #1a1a1a;
  --bg-overlay: #222222;
  
  --text-primary: #ffffff;
  --text-secondary: #b8bcc8;
  --text-muted: #666666;
  --text-hint: #444444;
  
  --border-soft: #333333;
  --border-medium: #444444;
  
  --accent-electric: #00d4ff;
  --accent-neon: #39ff14;
  --accent-purple: #8a2be2;
  --accent-orange: #ff4500;
  --accent-pink: #ff1493;
  --accent-gold: #ffd700;
  
  --gradient-primary: linear-gradient(135deg, var(--accent-electric), var(--accent-purple));
  --gradient-secondary: linear-gradient(135deg, var(--accent-neon), var(--accent-electric));
  --gradient-accent: linear-gradient(135deg, var(--accent-orange), var(--accent-pink));
  
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 20px;
  
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 20px;
  --space-2xl: 24px;
  --space-3xl: 32px;
  
  --transition: 0.3s ease;
}

* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

body {
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  line-height: 1.5;
  overflow-x: hidden;
  font-size: 14px;
}

/* =========================================================
   RESPONSIVE LAYOUT - WIDER ON DESKTOP
   ========================================================= */
.app-container {
  position: fixed;
  inset: 0;
  display: grid;
  grid-template-columns: 240px 1fr;
  overflow: hidden;
}

/* Desktop - make wider */
@media (min-width: 1200px) {
  .app-container {
    grid-template-columns: 260px 1fr;
  }
}

@media (min-width: 1400px) {
  .app-container {
    grid-template-columns: 280px 1fr;
  }
}

/* Tablet */
@media (max-width: 1024px) {
  .app-container {
    grid-template-columns: 220px 1fr;
  }
}

/* Mobile */
@media (max-width: 768px) {
  .app-container {
    grid-template-columns: 1fr;
  }
}

.sidebar {
  background: var(--bg-secondary);
  border-right: 1px solid var(--border-soft);
  padding: var(--space-md);
  overflow-y: auto;
}

@media (max-width: 768px) {
  .sidebar {
    position: fixed;
    left: -100%;
    top: 0;
    bottom: 0;
    width: 280px;
    z-index: 2000;
    transition: left var(--transition);
    box-shadow: 4px 0 20px rgba(0,0,0,0.5);
  }
  
  .sidebar.active {
    left: 0;
  }
  
  .sidebar-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.7);
    z-index: 1999;
    display: none;
  }
  
  .sidebar-overlay.active {
    display: block;
  }
}

.main-content {
  background: var(--bg-primary);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

/* =========================================================
   HEADER
   ========================================================= */
.header {
  background: var(--bg-secondary);
  border-bottom: 1px solid var(--border-soft);
  padding: var(--space-md) var(--space-lg);
  display: flex;
  align-items: center;
  justify-content: space-between;
  min-height: 60px;
}

.header-left {
  display: flex;
  align-items: center;
  gap: var(--space-md);
}

.menu-toggle {
  display: none;
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: 20px;
  cursor: pointer;
  padding: var(--space-sm);
  border-radius: var(--radius-sm);
}

.menu-toggle:hover {
  background: var(--bg-elevated);
}

@media (max-width: 768px) {
  .menu-toggle {
    display: block;
  }
}

.logo {
  font-size: 20px;
  font-weight: 900;
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

@media (max-width: 480px) {
  .logo {
    font-size: 16px;
  }
}

.header-actions {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.start-over-btn {
  background: var(--gradient-accent);
  color: white;
  border: none;
  padding: var(--space-xs) var(--space-md);
  border-radius: var(--radius-md);
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
  font-size: 12px;
}

.start-over-btn:hover {
  transform: scale(1.05);
}

@media (max-width: 480px) {
  .start-over-btn {
    padding: var(--space-xs) var(--space-sm);
    font-size: 11px;
  }
}

.user-info {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.user-name {
  color: var(--text-secondary);
  font-size: 12px;
}

@media (max-width: 480px) {
  .user-name {
    display: none;
  }
}

.avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--gradient-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
  font-size: 12px;
}

/* =========================================================
   ONBOARDING WIZARD - MOBILE FRIENDLY
   ========================================================= */
.onboarding-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.95);
  backdrop-filter: blur(10px);
  z-index: 3000;
  display: none;
  align-items: center;
  justify-content: center;
  padding: var(--space-lg);
}

.onboarding-overlay.active {
  display: flex;
}

.onboarding-wizard {
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-xl);
  width: 100%;
  max-width: 600px;
  max-height: 90vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

@media (max-width: 768px) {
  .onboarding-wizard {
    max-width: 95vw;
    max-height: 95vh;
  }
}

.wizard-header {
  background: var(--gradient-primary);
  padding: var(--space-lg);
  text-align: center;
  color: white;
}

.wizard-title {
  font-size: 20px;
  font-weight: 800;
  margin-bottom: var(--space-xs);
}

@media (max-width: 480px) {
  .wizard-title {
    font-size: 18px;
  }
}

.wizard-subtitle {
  opacity: 0.9;
  font-size: 12px;
}

.wizard-progress {
  padding: 0 var(--space-lg);
  background: var(--bg-elevated);
}

.progress-bar {
  width: 100%;
  height: 4px;
  background: var(--bg-card);
  margin: var(--space-md) 0;
}

.progress-fill {
  height: 100%;
  background: var(--gradient-primary);
  transition: width var(--transition);
}

.step-indicator {
  display: flex;
  justify-content: space-between;
  padding: var(--space-sm) 0;
  font-size: 10px;
  color: var(--text-muted);
}

@media (max-width: 480px) {
  .step-indicator {
    font-size: 9px;
    gap: var(--space-xs);
  }
}

.step-indicator .step {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-xs);
  flex: 1;
}

.step-indicator .step.active {
  color: var(--accent-electric);
  font-weight: 600;
}

.step-indicator .step.completed {
  color: var(--accent-neon);
}

.wizard-body {
  flex: 1;
  padding: var(--space-lg);
  overflow-y: auto;
}

@media (max-width: 480px) {
  .wizard-body {
    padding: var(--space-md);
  }
}

.wizard-step {
  display: none;
  text-align: center;
}

.wizard-step.active {
  display: block;
  animation: slideIn 0.3s ease;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateX(20px); }
  to { opacity: 1; transform: translateX(0); }
}

.step-title {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: var(--space-md);
}

@media (max-width: 480px) {
  .step-title {
    font-size: 16px;
  }
}

.step-description {
  color: var(--text-secondary);
  margin-bottom: var(--space-lg);
  line-height: 1.6;
  font-size: 13px;
}

.form-group {
  margin-bottom: var(--space-lg);
  text-align: left;
}

.form-label {
  display: block;
  font-weight: 600;
  margin-bottom: var(--space-xs);
  color: var(--text-primary);
  font-size: 13px;
}

.form-input, .form-select {
  width: 100%;
  background: var(--bg-elevated);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-md);
  padding: var(--space-md);
  color: var(--text-primary);
  font-size: 14px;
  font-family: inherit;
}

.form-input:focus, .form-select:focus {
  outline: none;
  border-color: var(--accent-electric);
  box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.2);
}

.options-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: var(--space-md);
  margin: var(--space-md) 0;
}

@media (max-width: 480px) {
  .options-grid {
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-sm);
  }
}

.option-card {
  background: var(--bg-elevated);
  border: 2px solid var(--border-soft);
  border-radius: var(--radius-md);
  padding: var(--space-md);
  text-align: center;
  cursor: pointer;
  transition: all var(--transition);
  min-height: 80px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.option-card:hover {
  border-color: var(--accent-electric);
  transform: translateY(-2px);
}

.option-card.selected {
  border-color: var(--accent-electric);
  background: rgba(0, 212, 255, 0.1);
}

.option-icon {
  font-size: 24px;
  margin-bottom: var(--space-xs);
}

@media (max-width: 480px) {
  .option-icon {
    font-size: 20px;
  }
}

.option-title {
  font-weight: 600;
  margin-bottom: var(--space-xs);
  font-size: 12px;
}

.option-desc {
  font-size: 10px;
  color: var(--text-muted);
  line-height: 1.3;
}

.wizard-actions {
  padding: var(--space-lg);
  background: var(--bg-elevated);
  display: flex;
  justify-content: space-between;
  gap: var(--space-md);
}

@media (max-width: 480px) {
  .wizard-actions {
    padding: var(--space-md);
  }
}

.btn {
  padding: var(--space-sm) var(--space-lg);
  border-radius: var(--radius-md);
  border: none;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
  font-size: 13px;
  font-family: inherit;
}

.btn-secondary {
  background: var(--bg-card);
  color: var(--text-secondary);
  border: 1px solid var(--border-soft);
}

.btn-secondary:hover {
  background: var(--bg-elevated);
  color: var(--text-primary);
}

.btn-primary {
  background: var(--gradient-primary);
  color: white;
}

.btn-primary:hover {
  transform: scale(1.02);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

/* =========================================================
   SIDEBAR NAVIGATION
   ========================================================= */
.nav-section {
  margin-bottom: var(--space-lg);
}

.nav-title {
  font-size: 10px;
  font-weight: 700;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: var(--space-sm);
  padding-left: var(--space-xs);
}

.nav-item {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  padding: var(--space-sm);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: all var(--transition);
  margin-bottom: var(--space-xs);
  font-weight: 500;
  color: var(--text-secondary);
  font-size: 13px;
  position: relative;
}

.nav-item:hover {
  background: var(--bg-elevated);
  color: var(--text-primary);
}

.nav-item.active {
  background: var(--gradient-primary);
  color: white;
  font-weight: 600;
}

.nav-icon {
  font-size: 16px;
  width: 18px;
  text-align: center;
}

.nav-badge {
  background: var(--accent-gold);
  color: var(--bg-primary);
  font-size: 9px;
  font-weight: 700;
  padding: 2px 5px;
  border-radius: 10px;
  margin-left: auto;
  min-width: 16px;
  text-align: center;
}

/* =========================================================
   CONTENT AREA - RESPONSIVE
   ========================================================= */
.content-area {
  flex: 1;
  overflow-y: auto;
  padding: var(--space-md);
}

@media (min-width: 1200px) {
  .content-area {
    padding: var(--space-lg);
  }
}

@media (max-width: 768px) {
  .content-area {
    padding: var(--space-sm);
  }
}

.section {
  display: none;
}

.section.active {
  display: block;
}

.dashboard-header {
  margin-bottom: var(--space-lg);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

@media (max-width: 768px) {
  .dashboard-header {
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-sm);
  }
}

.section-title {
  font-size: 24px;
  font-weight: 800;
  margin-bottom: var(--space-xs);
}

@media (max-width: 768px) {
  .section-title {
    font-size: 20px;
  }
}

@media (max-width: 480px) {
  .section-title {
    font-size: 18px;
  }
}

.section-subtitle {
  color: var(--text-secondary);
  font-size: 12px;
}

/* =========================================================
   RESPONSIVE DASHBOARD CARDS
   ========================================================= */
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: var(--space-md);
  margin-bottom: var(--space-lg);
}

@media (max-width: 1200px) {
  .dashboard-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 900px) {
  .dashboard-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .dashboard-grid {
    grid-template-columns: 1fr;
    gap: var(--space-sm);
  }
}

.dashboard-card {
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-lg);
  padding: var(--space-md);
  transition: all var(--transition);
  cursor: pointer;
  min-height: 120px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.dashboard-card:hover {
  border-color: var(--accent-electric);
  transform: translateY(-2px);
}

@media (max-width: 480px) {
  .dashboard-card {
    padding: var(--space-sm);
    min-height: 100px;
  }
}

.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-sm);
}

.card-title {
  font-size: 11px;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

@media (max-width: 480px) {
  .card-title {
    font-size: 10px;
  }
}

.card-icon {
  font-size: 18px;
  color: var(--accent-electric);
}

@media (max-width: 480px) {
  .card-icon {
    font-size: 16px;
  }
}

.card-value {
  font-size: 24px;
  font-weight: 900;
  color: var(--text-primary);
  margin-bottom: var(--space-xs);
  line-height: 1;
}

@media (max-width: 768px) {
  .card-value {
    font-size: 20px;
  }
}

@media (max-width: 480px) {
  .card-value {
    font-size: 18px;
  }
}

.card-change {
  font-size: 10px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: var(--space-xs);
}

.card-change.positive {
  color: var(--accent-neon);
}

.card-change.negative {
  color: var(--accent-orange);
}

.card-action {
  margin-top: var(--space-sm);
}

.card-btn {
  background: var(--gradient-primary);
  color: white;
  border: none;
  padding: var(--space-xs) var(--space-sm);
  border-radius: var(--radius-sm);
  font-size: 10px;
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
  width: 100%;
  font-family: inherit;
}

.card-btn:hover {
  transform: scale(1.02);
}

/* =========================================================
   CHARTS & ANALYTICS - RESPONSIVE
   ========================================================= */
.charts-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: var(--space-lg);
  margin-bottom: var(--space-lg);
}

@media (max-width: 900px) {
  .charts-grid {
    grid-template-columns: 1fr;
    gap: var(--space-md);
  }
}

.chart-card {
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
}

@media (max-width: 480px) {
  .chart-card {
    padding: var(--space-md);
  }
}

.chart-header {
  margin-bottom: var(--space-lg);
  text-align: center;
}

.chart-title {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: var(--space-xs);
}

@media (max-width: 480px) {
  .chart-title {
    font-size: 14px;
  }
}

.chart-subtitle {
  color: var(--text-secondary);
  font-size: 11px;
}

.donut-chart {
  position: relative;
  width: 180px;
  height: 180px;
  margin: 0 auto var(--space-md);
}

@media (max-width: 768px) {
  .donut-chart {
    width: 150px;
    height: 150px;
  }
}

@media (max-width: 480px) {
  .donut-chart {
    width: 120px;
    height: 120px;
  }
}

.chart-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

.chart-center-value {
  font-size: 20px;
  font-weight: 800;
  color: var(--text-primary);
}

@media (max-width: 480px) {
  .chart-center-value {
    font-size: 16px;
  }
}

.chart-center-label {
  font-size: 10px;
  color: var(--text-muted);
}

.chart-legend {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-md);
  justify-content: center;
}

@media (max-width: 480px) {
  .chart-legend {
    gap: var(--space-sm);
  }
}

.legend-item {
  display: flex;
  align-items: center;
  gap: var(--space-xs);
  font-size: 10px;
}

.legend-color {
  width: 10px;
  height: 10px;
  border-radius: 2px;
}

/* =========================================================
   TASKS & ACHIEVEMENTS - RESPONSIVE
   ========================================================= */
.tasks-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-md);
  margin-bottom: var(--space-lg);
}

@media (max-width: 1000px) {
  .tasks-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .tasks-grid {
    grid-template-columns: 1fr;
  }
}

.task-card {
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-lg);
  padding: var(--space-md);
  transition: all var(--transition);
}

.task-card.completed {
  border-color: var(--accent-neon);
  background: rgba(57, 255, 20, 0.05);
}

.task-header {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  margin-bottom: var(--space-md);
}

.task-icon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--gradient-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  color: white;
}

@media (max-width: 480px) {
  .task-icon {
    width: 28px;
    height: 28px;
    font-size: 12px;
  }
}

.task-info {
  flex: 1;
}

.task-title {
  font-weight: 700;
  margin-bottom: var(--space-xs);
  font-size: 13px;
}

@media (max-width: 480px) {
  .task-title {
    font-size: 12px;
  }
}

.task-points {
  font-size: 10px;
  color: var(--accent-gold);
  font-weight: 600;
}

.task-description {
  color: var(--text-secondary);
  font-size: 12px;
  margin-bottom: var(--space-md);
  line-height: 1.4;
}

@media (max-width: 480px) {
  .task-description {
    font-size: 11px;
  }
}

.task-progress {
  margin-bottom: var(--space-md);
}

.progress-info {
  display: flex;
  justify-content: space-between;
  font-size: 10px;
  margin-bottom: var(--space-xs);
}

.progress-bar {
  width: 100%;
  height: 6px;
  background: var(--bg-elevated);
  border-radius: 3px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: var(--gradient-primary);
  transition: width var(--transition);
}

.task-action {
  text-align: center;
}

.complete-btn {
  background: var(--gradient-secondary);
  color: white;
  border: none;
  padding: var(--space-xs) var(--space-md);
  border-radius: var(--radius-md);
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
  width: 100%;
  font-size: 11px;
  font-family: inherit;
}

.complete-btn:hover {
  transform: scale(1.02);
}

.complete-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

/* =========================================================
   EXPERT PROGRAMS - RESPONSIVE
   ========================================================= */
.program-filters {
  display: flex;
  gap: var(--space-sm);
  margin-bottom: var(--space-lg);
  flex-wrap: wrap;
}

@media (max-width: 480px) {
  .program-filters {
    gap: var(--space-xs);
  }
}

.program-filter {
  background: var(--bg-card);
  color: var(--text-secondary);
  border: 1px solid var(--border-soft);
  padding: var(--space-xs) var(--space-md);
  border-radius: var(--radius-md);
  font-size: 11px;
  cursor: pointer;
  transition: all var(--transition);
  font-family: inherit;
}

.program-filter.active {
  background: var(--gradient-primary);
  color: white;
  border-color: transparent;
}

@media (max-width: 480px) {
  .program-filter {
    padding: var(--space-xs) var(--space-sm);
    font-size: 10px;
  }
}

.programs-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-lg);
  margin-bottom: var(--space-lg);
}

@media (max-width: 1000px) {
  .programs-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 600px) {
  .programs-grid {
    grid-template-columns: 1fr;
  }
}

.program-card {
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-lg);
  overflow: hidden;
  transition: all var(--transition);
  cursor: pointer;
}

.program-card:hover {
  transform: translateY(-4px);
  border-color: var(--accent-electric);
}

.program-header {
  height: 120px;
  background: var(--gradient-primary);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

@media (max-width: 480px) {
  .program-header {
    height: 100px;
  }
}

.program-header::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.1));
}

.program-icon {
  font-size: 36px;
  position: relative;
  z-index: 1;
}

@media (max-width: 480px) {
  .program-icon {
    font-size: 30px;
  }
}

.program-body {
  padding: var(--space-md);
}

@media (max-width: 480px) {
  .program-body {
    padding: var(--space-sm);
  }
}

.program-title {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: var(--space-sm);
}

@media (max-width: 480px) {
  .program-title {
    font-size: 14px;
  }
}

.program-description {
  color: var(--text-secondary);
  font-size: 12px;
  margin-bottom: var(--space-md);
  line-height: 1.4;
}

@media (max-width: 480px) {
  .program-description {
    font-size: 11px;
  }
}

.program-stats {
  display: flex;
  justify-content: space-between;
  margin-bottom: var(--space-md);
  font-size: 10px;
}

.program-stat {
  text-align: center;
}

.stat-value {
  font-weight: 700;
  color: var(--accent-electric);
  display: block;
  font-size: 12px;
}

@media (max-width: 480px) {
  .stat-value {
    font-size: 11px;
  }
}

.stat-label {
  color: var(--text-muted);
  font-size: 9px;
}

.program-action {
  text-align: center;
}

.join-btn {
  background: var(--gradient-accent);
  color: white;
  border: none;
  padding: var(--space-sm) var(--space-md);
  border-radius: var(--radius-md);
  font-weight: 600;
  cursor: pointer;
  transition: all var(--transition);
  width: 100%;
  font-size: 11px;
  font-family: inherit;
}

.join-btn:hover {
  transform: scale(1.02);
}

@media (max-width: 480px) {
  .join-btn {
    font-size: 10px;
    padding: var(--space-xs) var(--space-sm);
  }
}

/* =========================================================
   CHAT SYSTEM - MOBILE OPTIMIZED
   ========================================================= */
.chat-container {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 800px;
  height: 80%;
  max-height: 600px;
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-xl);
  display: none;
  flex-direction: column;
  z-index: 2500;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
}

.chat-container.active {
  display: flex;
}

@media (max-width: 768px) {
  .chat-container {
    width: 95%;
    height: 90%;
    max-height: none;
  }
}

.chat-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(4px);
  z-index: 2499;
  display: none;
}

.chat-overlay.active {
  display: block;
}

.chat-header {
  padding: var(--space-md);
  border-bottom: 1px solid var(--border-soft);
  background: var(--gradient-primary);
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-radius: var(--radius-xl) var(--radius-xl) 0 0;
}

.chat-title {
  font-size: 16px;
  font-weight: 800;
  color: white;
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

@media (max-width: 480px) {
  .chat-title {
    font-size: 14px;
  }
}

.chat-close {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: white;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all var(--transition);
  font-size: 14px;
}

.chat-close:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.1);
}

.chat-messages {
  flex: 1;
  padding: var(--space-md);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: var(--space-md);
}

@media (max-width: 480px) {
  .chat-messages {
    padding: var(--space-sm);
    gap: var(--space-sm);
  }
}

.message {
  display: flex;
  gap: var(--space-sm);
  align-items: flex-start;
  max-width: 85%;
}

.message.user {
  flex-direction: row-reverse;
  align-self: flex-end;
}

.message-avatar {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 700;
  font-size: 11px;
  flex-shrink: 0;
}

@media (max-width: 480px) {
  .message-avatar {
    width: 24px;
    height: 24px;
    font-size: 10px;
  }
}

.message.ai .message-avatar {
  background: var(--gradient-primary);
  color: white;
}

.message.user .message-avatar {
  background: var(--gradient-accent);
  color: white;
}

.message-content {
  background: var(--bg-elevated);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-md);
  padding: var(--space-sm);
  font-size: 13px;
  line-height: 1.4;
}

@media (max-width: 480px) {
  .message-content {
    font-size: 12px;
  }
}

.message.user .message-content {
  background: var(--gradient-secondary);
  color: white;
  border: none;
}

.chat-input {
  padding: var(--space-md);
  border-top: 1px solid var(--border-soft);
  background: var(--bg-elevated);
  border-radius: 0 0 var(--radius-xl) var(--radius-xl);
}

@media (max-width: 480px) {
  .chat-input {
    padding: var(--space-sm);
  }
}

.input-group {
  display: flex;
  gap: var(--space-sm);
  align-items: flex-end;
}

.message-input {
  flex: 1;
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-md);
  padding: var(--space-sm);
  color: var(--text-primary);
  resize: none;
  min-height: 36px;
  max-height: 80px;
  font-family: inherit;
  font-size: 13px;
}

.message-input:focus {
  outline: none;
  border-color: var(--accent-electric);
  box-shadow: 0 0 0 2px rgba(0, 212, 255, 0.2);
}

.send-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: var(--gradient-primary);
  color: white;
  border: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all var(--transition);
  font-size: 14px;
}

.send-btn:hover {
  transform: scale(1.05);
}

/* =========================================================
   FLOATING CHAT BUTTON
   ========================================================= */
.chat-trigger {
  position: fixed;
  bottom: var(--space-lg);
  right: var(--space-lg);
  width: 50px;
  height: 50px;
  border-radius: 50%;
  background: var(--gradient-primary);
  color: white;
  border: none;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
  transition: all var(--transition);
  z-index: 1000;
}

.chat-trigger:hover {
  transform: scale(1.1);
}

@media (max-width: 480px) {
  .chat-trigger {
    width: 45px;
    height: 45px;
    font-size: 16px;
    bottom: var(--space-md);
    right: var(--space-md);
  }
}

/* =========================================================
   ACHIEVEMENT POPUP - MOBILE FRIENDLY
   ========================================================= */
.achievement-popup {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--gradient-secondary);
  border-radius: var(--radius-lg);
  padding: var(--space-md);
  color: white;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
  transform: translateX(400px);
  transition: transform var(--transition);
  z-index: 2000;
  max-width: 280px;
}

.achievement-popup.show {
  transform: translateX(0);
}

@media (max-width: 480px) {
  .achievement-popup {
    top: 10px;
    right: 10px;
    left: 10px;
    max-width: none;
    transform: translateY(-100px);
  }
  
  .achievement-popup.show {
    transform: translateY(0);
  }
}

.achievement-content {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.achievement-icon {
  font-size: 28px;
}

@media (max-width: 480px) {
  .achievement-icon {
    font-size: 24px;
  }
}

.achievement-text {
  flex: 1;
}

.achievement-title {
  font-weight: 700;
  margin-bottom: var(--space-xs);
  font-size: 13px;
}

.achievement-desc {
  font-size: 11px;
  opacity: 0.9;
}

/* =========================================================
   UTILITY CLASSES
   ========================================================= */
.hidden {
  display: none !important;
}

.loading {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid var(--border-soft);
  border-radius: 50%;
  border-top-color: var(--accent-electric);
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.text-center { text-align: center; }
.mb-lg { margin-bottom: var(--space-lg); }
.mt-lg { margin-top: var(--space-lg); }
.fw-bold { font-weight: 700; }
.text-success { color: var(--accent-neon); }
.text-warning { color: var(--accent-orange); }
.text-info { color: var(--accent-electric); }

/* =========================================================
   CONSTRUCTION PLACEHOLDERS
   ========================================================= */
.construction-placeholder {
  background: var(--bg-card);
  padding: var(--space-3xl);
  border-radius: var(--radius-lg);
  text-align: center;
  border: 1px solid var(--border-soft);
}

@media (max-width: 480px) {
  .construction-placeholder {
    padding: var(--space-lg);
  }
}

.construction-icon {
  font-size: 48px;
  margin-bottom: var(--space-md);
}

@media (max-width: 480px) {
  .construction-icon {
    font-size: 36px;
  }
}

.construction-title {
  margin-bottom: var(--space-sm);
  font-size: 18px;
  font-weight: 700;
}

@media (max-width: 480px) {
  .construction-title {
    font-size: 16px;
  }
}

.construction-desc {
  color: var(--text-secondary);
  font-size: 13px;
}

@media (max-width: 480px) {
  .construction-desc {
    font-size: 12px;
  }
}

/* Two column form for small inputs */
.form-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-md);
}

@media (max-width: 480px) {
  .form-row {
    grid-template-columns: 1fr;
    gap: var(--space-sm);
  }
}

/* Large grid single column */
.options-grid-single {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--space-md);
  margin: var(--space-md) 0;
}

/* Info boxes */
.info-box {
  background: var(--bg-elevated);
  padding: var(--space-md);
  border-radius: var(--radius-md);
  margin: var(--space-md) 0;
}

@media (max-width: 480px) {
  .info-box {
    padding: var(--space-sm);
  }
}

.info-highlight {
  color: var(--accent-electric);
  font-weight: 600;
  margin-bottom: var(--space-xs);
}

.info-list {
  color: var(--text-secondary);
  text-align: left;
  padding-left: var(--space-lg);
  font-size: 12px;
}

@media (max-width: 480px) {
  .info-list {
    font-size: 11px;
    padding-left: var(--space-md);
  }
}

/* Summary box */
.summary-box {
  background: var(--gradient-primary);
  padding: var(--space-md);
  border-radius: var(--radius-md);
  color: white;
  text-align: center;
  margin: var(--space-md) 0;
}

.summary-title {
  font-weight: 700;
  margin-bottom: var(--space-xs);
}

.summary-content {
  font-size: 12px;
  opacity: 0.9;
  line-height: 1.5;
}

@media (max-width: 480px) {
  .summary-content {
    font-size: 11px;
  }
}
  </style>
</head>
<body>
  <!-- Sidebar Overlay for Mobile -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- Onboarding Wizard -->
  <div class="onboarding-overlay" id="onboardingOverlay">
    <div class="onboarding-wizard">
      <div class="wizard-header">
        <h1 class="wizard-title">Sveiki atvykę į FitAI Pro!</h1>
        <p class="wizard-subtitle">Sukurkime jūsų personalizuotą sveikos gyvensenos planą</p>
      </div>
      
      <div class="wizard-progress">
        <div class="progress-bar">
          <div class="progress-fill" id="wizardProgress" style="width: 16.67%;"></div>
        </div>
        <div class="step-indicator">
          <div class="step active" data-step="1">
            <span>👋</span>
            <span>Pažintis</span>
          </div>
          <div class="step" data-step="2">
            <span>📊</span>
            <span>Duomenys</span>
          </div>
          <div class="step" data-step="3">
            <span>🎯</span>
            <span>Tikslai</span>
          </div>
          <div class="step" data-step="4">
            <span>🏃</span>
            <span>Aktyvumas</span>
          </div>
          <div class="step" data-step="5">
            <span>🍽️</span>
            <span>Mityba</span>
          </div>
          <div class="step" data-step="6">
            <span>🚀</span>
            <span>Pabaiga</span>
          </div>
        </div>
      </div>
      
      <div class="wizard-body">
        <!-- Step 1: Welcome -->
        <div class="wizard-step active" data-step="1">
          <h2 class="step-title">Labas! Aš esu jūsų AI fitness treneris!</h2>
          <p class="step-description">
            Aš padėsiu jums pasiekti sveikatos ir sporto tikslus. Per 6 žingsnius sukursime jums tobulą planą.
            Nereikia jokių sportinio renginio žinių - aš viską paaiškinsiu paprastai ir suprantamai!
          </p>
          <div class="info-box">
            <p class="info-highlight">Ką mes padarysime:</p>
            <ul class="info-list">
              <li>Sužinosime apie jus ir jūsų tikslus</li>
              <li>Sukursime personalizuotą treniruočių programą</li>
              <li>Suplanuosime mitybą pagal jūsų pomėgius</li>
              <li>Nustatysime atsekimo sistemą</li>
              <li>Pradėsime jūsų transformacijos kelionę!</li>
            </ul>
          </div>
        </div>

        <!-- Step 2: Personal Data -->
        <div class="wizard-step" data-step="2">
          <h2 class="step-title">Papasakokite apie save</h2>
          <p class="step-description">
            Šie duomenys padės man sukurti jums tinkamą planą. Visi duomenys yra saugūs ir naudojami tik jūsų tikslams.
          </p>
          
          <div class="form-group">
            <label class="form-label">Jūsų vardas</label>
            <input type="text" class="form-input" id="userName" placeholder="Įveskite vardą">
          </div>
          
          <div class="form-group">
            <label class="form-label">Amžius</label>
            <input type="number" class="form-input" id="userAge" placeholder="Metai" min="16" max="100">
          </div>
          
          <div class="form-group">
            <label class="form-label">Lytis</label>
            <div class="options-grid">
              <div class="option-card" data-value="male">
                <div class="option-icon">👨</div>
                <div class="option-title">Vyras</div>
              </div>
              <div class="option-card" data-value="female">
                <div class="option-icon">👩</div>
                <div class="option-title">Moteris</div>
              </div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">Ūgis (cm)</label>
              <input type="number" class="form-input" id="userHeight" placeholder="170" min="120" max="250">
            </div>
            <div class="form-group">
              <label class="form-label">Svoris (kg)</label>
              <input type="number" class="form-input" id="userWeight" placeholder="70" min="30" max="300">
            </div>
          </div>
        </div>

        <!-- Step 3: Goals -->
        <div class="wizard-step" data-step="3">
          <h2 class="step-title">Kokie jūsų tikslai?</h2>
          <p class="step-description">
            Pasirinkite pagrindinį tikslą. Galėsite jį keisti vėliau, bet tai padės man sukurti pradinį planą.
          </p>
          
          <div class="options-grid">
            <div class="option-card" data-value="lose_weight">
              <div class="option-icon">⬇️</div>
              <div class="option-title">Numesti svorio</div>
              <div class="option-desc">Sudeginimas riebalų ir svorio mažinimas</div>
            </div>
            <div class="option-card" data-value="gain_muscle">
              <div class="option-icon">💪</div>
              <div class="option-title">Auginti raumenis</div>
              <div class="option-desc">Raumenų masės didinimas ir jėgos ugdymas</div>
            </div>
            <div class="option-card" data-value="get_fit">
              <div class="option-icon">🏃</div>
              <div class="option-title">Būti formos</div>
              <div class="option-desc">Bendras fizinis pajėgumas ir sveikata</div>
            </div>
            <div class="option-card" data-value="maintain">
              <div class="option-icon">⚖️</div>
              <div class="option-title">Išlaikyti formą</div>
              <div class="option-desc">Dabartinio lygio palaikymas</div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Tikslas svoris (kg) - nebūtina</label>
            <input type="number" class="form-input" id="targetWeight" placeholder="Pageidautinas svoris">
          </div>
        </div>

        <!-- Step 4: Activity Level -->
        <div class="wizard-step" data-step="4">
          <h2 class="step-title">Koks jūsų aktyvumo lygis?</h2>
          <p class="step-description">
            Pasirinkite, kiek dabar sportuojate. Tai padės sukurti realų ir pasiekiamą planą.
          </p>
          
          <div class="options-grid-single">
            <div class="option-card" data-value="sedentary">
              <div class="option-icon">🪑</div>
              <div class="option-title">Mažai aktyvus</div>
              <div class="option-desc">Darbas prie stalo, sportuoju retai arba niekada</div>
            </div>
            <div class="option-card" data-value="light">
              <div class="option-icon">🚶</div>
              <div class="option-title">Lengvai aktyvus</div>
              <div class="option-desc">Lengvas sportas 1-3 kartus per savaitę</div>
            </div>
            <div class="option-card" data-value="moderate">
              <div class="option-icon">🏃</div>
              <div class="option-title">Vidutiniškai aktyvus</div>
              <div class="option-desc">Sportuoju 3-5 kartus per savaitę</div>
            </div>
            <div class="option-card" data-value="active">
              <div class="option-icon">💪</div>
              <div class="option-title">Labai aktyvus</div>
              <div class="option-desc">Intensyvus sportas 6-7 kartus per savaitę</div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Kiek kartų per savaitę norėtumėte treniruotis?</label>
            <select class="form-select" id="workoutFrequency">
              <option value="2">2 kartus per savaitę</option>
              <option value="3" selected>3 kartus per savaitę</option>
              <option value="4">4 kartus per savaitę</option>
              <option value="5">5 kartus per savaitę</option>
              <option value="6">6 kartus per savaitę</option>
            </select>
          </div>
        </div>

        <!-- Step 5: Nutrition -->
        <div class="wizard-step" data-step="5">
          <h2 class="step-title">Mitybos pageidavimai</h2>
          <p class="step-description">
            Pasakykite apie savo mitybos stilių ir pageidavimus. Tai padės sukurti skanų ir tinkamą valgiaraštį.
          </p>
          
          <div class="form-group">
            <label class="form-label">Mitybos stilius</label>
            <div class="options-grid">
              <div class="option-card" data-value="normal">
                <div class="option-icon">🍽️</div>
                <div class="option-title">Įprastas</div>
                <div class="option-desc">Valgau viską</div>
              </div>
              <div class="option-card" data-value="vegetarian">
                <div class="option-icon">🥗</div>
                <div class="option-title">Vegetaras</div>
                <div class="option-desc">Be mėsos</div>
              </div>
              <div class="option-card" data-value="vegan">
                <div class="option-icon">🌱</div>
                <div class="option-title">Veganas</div>
                <div class="option-desc">Tik augaliniai produktai</div>
              </div>
              <div class="option-card" data-value="keto">
                <div class="option-icon">🥑</div>
                <div class="option-title">Keto</div>
                <div class="option-desc">Mažai angliavandenių</div>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Kiek kartų per dieną valgote?</label>
            <select class="form-select" id="mealsPerDay">
              <option value="3">3 kartus (pusryčiai, pietūs, vakarienė)</option>
              <option value="4">4 kartus (+ 1 užkandis)</option>
              <option value="5" selected>5 kartus (+ 2 užkandžiai)</option>
              <option value="6">6 kartus (+ 3 užkandžiai)</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Ar turite alergijų maistui? (nebūtina)</label>
            <input type="text" class="form-input" id="allergies" placeholder="Pvz.: riešutai, pieno produktai">
          </div>
        </div>

        <!-- Step 6: Completion -->
        <div class="wizard-step" data-step="6">
          <h2 class="step-title">Viskas paruošta! 🎉</h2>
          <p class="step-description">
            Puiku! Dabar aš sukūriu jums personalizuotą planą. Štai ką gausite:
          </p>
          
          <div class="options-grid">
            <div class="info-box">
              <div style="font-size: 32px; margin-bottom: 8px; text-align: center;">💪</div>
              <div style="font-weight: 600; margin-bottom: 4px; text-align: center;">Treniruočių planas</div>
              <div style="font-size: 12px; color: var(--text-muted); text-align: center;">Personalizuotos treniruotės</div>
            </div>
            <div class="info-box">
              <div style="font-size: 32px; margin-bottom: 8px; text-align: center;">🍽️</div>
              <div style="font-weight: 600; margin-bottom: 4px; text-align: center;">Mitybos planas</div>
              <div style="font-size: 12px; color: var(--text-muted); text-align: center;">Skanūs ir sveiki receptai</div>
            </div>
            <div class="info-box">
              <div style="font-size: 32px; margin-bottom: 8px; text-align: center;">📊</div>
              <div style="font-weight: 600; margin-bottom: 4px; text-align: center;">Pažangos sekimas</div>
              <div style="font-size: 12px; color: var(--text-muted); text-align: center;">Detalūs grafikai ir analizė</div>
            </div>
            <div class="info-box">
              <div style="font-size: 32px; margin-bottom: 8px; text-align: center;">🤖</div>
              <div style="font-weight: 600; margin-bottom: 4px; text-align: center;">AI asistentas</div>
              <div style="font-size: 12px; color: var(--text-muted); text-align: center;">24/7 pagalba ir patarimai</div>
            </div>
          </div>
          
          <div class="summary-box">
            <div class="summary-title">Jūsų plano santrauka:</div>
            <div id="planSummary" class="summary-content"></div>
          </div>
          
          <p style="color: var(--text-muted); font-size: 12px; text-align: center;">
            Galėsite keisti visus nustatymus bet kada vėliau platformoje.
          </p>
        </div>
      </div>
      
      <div class="wizard-actions">
        <button class="btn btn-secondary" id="prevBtn" disabled>Atgal</button>
        <button class="btn btn-primary" id="nextBtn">Toliau</button>
      </div>
    </div>
  </div>

  <div class="app-container">
    <!-- Sidebar Navigation -->
    <div class="sidebar" id="sidebar">
      <div class="nav-section">
        <div class="nav-title">Pagrindinis</div>
        <div class="nav-item active" data-section="dashboard">
          <span class="nav-icon">🏠</span>
          <span>Valdymo skydas</span>
          <span class="nav-badge" id="taskBadge">3</span>
        </div>
        <div class="nav-item" data-section="workouts">
          <span class="nav-icon">💪</span>
          <span>Treniruotės</span>
        </div>
        <div class="nav-item" data-section="nutrition">
          <span class="nav-icon">🥗</span>
          <span>Mityba</span>
        </div>
        <div class="nav-item" data-section="progress">
          <span class="nav-icon">📊</span>
          <span>Pažanga</span>
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">AI Funkcijos</div>
        <div class="nav-item" data-section="ai-coach">
          <span class="nav-icon">🤖</span>
          <span>AI Treneris</span>
        </div>
        <div class="nav-item" data-section="meal-planning">
          <span class="nav-icon">🍽️</span>
          <span>Patiekalų planavimas</span>
        </div>
        <div class="nav-item" data-section="body-analysis">
          <span class="nav-icon">📷</span>
          <span>Kūno analizė</span>
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">Premium</div>
        <div class="nav-item" data-section="analytics">
          <span class="nav-icon">📈</span>
          <span>Analitika</span>
        </div>
        <div class="nav-item" data-section="programs">
          <span class="nav-icon">🎯</span>
          <span>Ekspertų programos</span>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content">
      <!-- Header -->
      <div class="header">
        <div class="header-left">
          <button class="menu-toggle" id="menuToggle">☰</button>
          <div class="logo">FitAI Pro</div>
        </div>
        <div class="header-actions">
          <button class="start-over-btn" id="startOverBtn">🚀 Pradėti iš naujo</button>
          <div class="user-info">
            <span class="user-name" id="welcomeText">Sveiki, Tomas</span>
            <div class="avatar" id="userAvatar">T</div>
          </div>
        </div>
      </div>

      <!-- Content Area -->
      <div class="content-area">
        <!-- Dashboard Section -->
        <div class="section active" id="dashboard">
          <div class="dashboard-header">
            <div>
              <h1 class="section-title">Valdymo skydas</h1>
              <p class="section-subtitle">Jūsų sveikatos ir sporto pažangos apžvalga</p>
            </div>
          </div>

          <!-- Dashboard Cards -->
          <div class="dashboard-grid">
            <div class="dashboard-card" data-action="weight">
              <div class="card-header">
                <span class="card-title">Dabartinis svoris</span>
                <span class="card-icon">⚖️</span>
              </div>
              <div class="card-value" id="currentWeight">78.2kg</div>
              <div class="card-change positive">
                <span>↘</span>
                <span>-0.4kg šią savaitę</span>
              </div>
              <div class="card-action">
                <button class="card-btn">Atnaujinti svorį</button>
              </div>
            </div>

            <div class="dashboard-card" data-action="workout">
              <div class="card-header">
                <span class="card-title">Šios savaitės treniruotės</span>
                <span class="card-icon">💪</span>
              </div>
              <div class="card-value" id="weeklyWorkouts">4/5</div>
              <div class="card-change positive">
                <span>↗</span>
                <span>80% tikslo</span>
              </div>
              <div class="card-action">
                <button class="card-btn">Pridėti treniruotę</button>
              </div>
            </div>

            <div class="dashboard-card" data-action="meal">
              <div class="card-header">
                <span class="card-title">Šiandien kalorijos</span>
                <span class="card-icon">🔥</span>
              </div>
              <div class="card-value" id="todayCalories">1,847</div>
              <div class="card-change positive">
                <span>📊</span>
                <span>-453 iki tikslo</span>
              </div>
              <div class="card-action">
                <button class="card-btn">Pridėti maistą</button>
              </div>
            </div>

            <div class="dashboard-card" data-action="sleep">
              <div class="card-header">
                <span class="card-title">Miego kokybė</span>
                <span class="card-icon">😴</span>
              </div>
              <div class="card-value" id="sleepQuality">8.2h</div>
              <div class="card-change positive">
                <span>↗</span>
                <span>+23min vakar</span>
              </div>
              <div class="card-action">
                <button class="card-btn">Pridėti miegą</button>
              </div>
            </div>
          </div>

          <!-- Tasks & Achievements -->
          <div style="margin-bottom: 24px;">
            <h3 style="margin-bottom: 12px; font-size: 18px;">Šiandienos užduotys</h3>
            <div class="tasks-grid">
              <div class="task-card" id="task-workout">
                <div class="task-header">
                  <div class="task-icon">💪</div>
                  <div class="task-info">
                    <div class="task-title">Atlikti Push Day treniruotę</div>
                    <div class="task-points">+50 taškų</div>
                  </div>
                </div>
                <div class="task-description">
                  Atlikite šiandien suplanuotą krūtinės ir pečių treniruotę
                </div>
                <div class="task-progress">
                  <div class="progress-info">
                    <span>Pažanga</span>
                    <span id="workoutProgress">0/10 pratimų</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="workoutProgressBar" style="width: 0%;"></div>
                  </div>
                </div>
                <div class="task-action">
                  <button class="complete-btn" data-task="workout">Pradėti treniruotę</button>
                </div>
              </div>

              <div class="task-card" id="task-nutrition">
                <div class="task-header">
                  <div class="task-icon">🥗</div>
                  <div class="task-info">
                    <div class="task-title">Suvartoti 150g baltymų</div>
                    <div class="task-points">+30 taškų</div>
                  </div>
                </div>
                <div class="task-description">
                  Pasiekite šiandienos baltymų tikslą sveikai mitybai
                </div>
                <div class="task-progress">
                  <div class="progress-info">
                    <span>Pažanga</span>
                    <span id="proteinProgress">127/150g</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="proteinProgressBar" style="width: 85%;"></div>
                  </div>
                </div>
                <div class="task-action">
                  <button class="complete-btn" data-task="nutrition">Pridėti maistą</button>
                </div>
              </div>

              <div class="task-card" id="task-water">
                <div class="task-header">
                  <div class="task-icon">💧</div>
                  <div class="task-info">
                    <div class="task-title">Išgerti 2.5L vandens</div>
                    <div class="task-points">+20 taškų</div>
                  </div>
                </div>
                <div class="task-description">
                  Išlaikykite optimalų hidratavimo lygį visą dieną
                </div>
                <div class="task-progress">
                  <div class="progress-info">
                    <span>Pažanga</span>
                    <span id="waterProgress">1.6/2.5L</span>
                  </div>
                  <div class="progress-bar">
                    <div class="progress-fill" id="waterProgressBar" style="width: 64%;"></div>
                  </div>
                </div>
                <div class="task-action">
                  <button class="complete-btn" data-task="water">Pridėti vandens</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Charts Grid -->
          <div class="charts-grid">
            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">Šiandien suvartota</h3>
                <p class="chart-subtitle">Makroelementų paskirstymas</p>
              </div>
              <div class="donut-chart">
                <canvas id="macrosChart" width="180" height="180"></canvas>
                <div class="chart-center">
                  <div class="chart-center-value">1,847</div>
                  <div class="chart-center-label">kalorijų</div>
                </div>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color" style="background: #00d4ff;"></div>
                  <span>Angliavandeniai (45%)</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #39ff14;"></div>
                  <span>Baltymai (30%)</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #ff4500;"></div>
                  <span>Riebalai (25%)</span>
                </div>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">Kūno sudėtis</h3>
                <p class="chart-subtitle">Pažangos analizė</p>
              </div>
              <div class="donut-chart">
                <canvas id="bodyCompositionChart" width="180" height="180"></canvas>
                <div class="chart-center">
                  <div class="chart-center-value">18.2%</div>
                  <div class="chart-center-label">kūno riebalų</div>
                </div>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color" style="background: #8a2be2;"></div>
                  <span>Raumenų masė (67%)</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #ff1493;"></div>
                  <span>Kūno riebalai (18%)</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #666666;"></div>
                  <span>Kita (15%)</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Analytics Section -->
        <div class="section" id="analytics">
          <div class="dashboard-header">
            <div>
              <h1 class="section-title">Analitika</h1>
              <p class="section-subtitle">Išsamūs jūsų pažangos duomenys ir AI įžvalgos</p>
            </div>
          </div>

          <!-- Analytics Cards -->
          <div class="dashboard-grid">
            <div class="dashboard-card">
              <div class="card-header">
                <span class="card-title">Svorio pokyčio tendencija</span>
                <span class="card-icon">📉</span>
              </div>
              <div class="card-value">-0.3kg/sav</div>
              <div class="card-change positive">
                <span>🎯</span>
                <span>Optimalus tempas</span>
              </div>
            </div>

            <div class="dashboard-card">
              <div class="card-header">
                <span class="card-title">Metabolizmo sparta</span>
                <span class="card-icon">🔥</span>
              </div>
              <div class="card-value">2,247</div>
              <div class="card-change positive">
                <span>↗</span>
                <span>+47 kcal/dieną</span>
              </div>
            </div>

            <div class="dashboard-card">
              <div class="card-header">
                <span class="card-title">Treniruočių efektyvumas</span>
                <span class="card-icon">💯</span>
              </div>
              <div class="card-value">94%</div>
              <div class="card-change positive">
                <span>⭐</span>
                <span>Puikus rezultatas</span>
              </div>
            </div>

            <div class="dashboard-card">
              <div class="card-header">
                <span class="card-title">AI tikslumas</span>
                <span class="card-icon">🤖</span>
              </div>
              <div class="card-value">97.2%</div>
              <div class="card-change positive">
                <span>📈</span>
                <span>Nuolat mokosi</span>
              </div>
            </div>
          </div>

          <!-- Advanced Analytics Charts -->
          <div class="charts-grid">
            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">30 dienų svorio tendencija</h3>
                <p class="chart-subtitle">AI prognozuoja jūsų pažangą</p>
              </div>
              <div class="donut-chart">
                <canvas id="weightTrendChart" width="180" height="180"></canvas>
                <div class="chart-center">
                  <div class="chart-center-value">-2.1kg</div>
                  <div class="chart-center-label">per mėnesį</div>
                </div>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color" style="background: #39ff14;"></div>
                  <span>Pasiekta (78%)</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #00d4ff;"></div>
                  <span>Liko (22%)</span>
                </div>
              </div>
            </div>

            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">Miego kokybės analizė</h3>
                <p class="chart-subtitle">Atsigavimo optimizavimas</p>
              </div>
              <div class="donut-chart">
                <canvas id="sleepAnalysisChart" width="180" height="180"></canvas>
                <div class="chart-center">
                  <div class="chart-center-value">8.2h</div>
                  <div class="chart-center-label">vidutiniškai</div>
                </div>
              </div>
              <div class="chart-legend">
                <div class="legend-item">
                  <div class="legend-color" style="background: #8a2be2;"></div>
                  <span>Gilus miegas (65%)</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #00d4ff;"></div>
                  <span>Lengvas miegas (25%)</span>
                </div>
                <div class="legend-item">
                  <div class="legend-color" style="background: #ff4500;"></div>
                  <span>REM (10%)</span>
                </div>
              </div>
            </div>
          </div>

          <!-- AI Insights -->
          <div class="info-box">
            <h3 style="margin-bottom: 16px; color: var(--accent-electric);">🤖 AI įžvalgos ir rekomendacijos</h3>
            <div class="options-grid">
              <div class="info-box">
                <div style="font-weight: 600; margin-bottom: 8px; color: var(--accent-neon);">✅ Puikiai sekasi</div>
                <div style="color: var(--text-secondary); font-size: 12px;">
                  Jūsų treniruočių konsistencija yra puiki - 94% lankumo per pastarąsias 4 savaites. Tai garantuoja stabilius rezultatus.
                </div>
              </div>
              <div class="info-box">
                <div style="font-weight: 600; margin-bottom: 8px; color: var(--accent-orange);">⚡ Galima pagerinti</div>
                <div style="color: var(--text-secondary); font-size: 12px;">
                  Rekomenduoju padidinti vandens suvartojimą iki 3L per dieną - tai pagerins metabolizmą 12-15%.
                </div>
              </div>
              <div class="info-box">
                <div style="font-weight: 600; margin-bottom: 8px; color: var(--accent-electric);">📊 Prognozė</div>
                <div style="color: var(--text-secondary); font-size: 12px;">
                  Tęsiant dabartinį tempą, jūsų tikslas bus pasiektas per 6.2 savaites su 94% tikimybe.
                </div>
              </div>
              <div class="info-box">
                <div style="font-weight: 600; margin-bottom: 8px; color: var(--accent-purple);">🎯 Kitas žingsnis</div>
                <div style="color: var(--text-secondary); font-size: 12px;">
                  Siūlau pridėti 15min cardio po jėgos treniruočių - tai paspartins rezultatus 23%.
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Programs Section -->
        <div class="section" id="programs">
          <div class="dashboard-header">
            <div>
              <h1 class="section-title">Ekspertų programos</h1>
              <p class="section-subtitle">AI optimizuotos programos nuo pasaulio klasės trenerių</p>
            </div>
          </div>

          <!-- Program Categories -->
          <div class="program-filters">
            <button class="program-filter active" data-filter="all">Visos programos</button>
            <button class="program-filter" data-filter="beginner">Pradedantiems</button>
            <button class="program-filter" data-filter="intermediate">Pažengusiems</button>
            <button class="program-filter" data-filter="advanced">Ekspertams</button>
          </div>

          <!-- Programs Grid -->
          <div class="programs-grid">
            <div class="program-card" data-level="beginner">
              <div class="program-header" style="background: linear-gradient(135deg, #00d4ff, #8a2be2);">
                <div class="program-icon">🔥</div>
              </div>
              <div class="program-body">
                <h3 class="program-title">Fat Burn Revolution</h3>
                <p class="program-description">
                  12 savaičių intensyvi programa riebalų deginimui. HIIT + jėgos treniruotės + mitybos planas. Vidutiniškai -8.5kg rezultatai.
                </p>
                <div class="program-stats">
                  <div class="program-stat">
                    <span class="stat-value">12</span>
                    <span class="stat-label">savaičių</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">4.8★</span>
                    <span class="stat-label">reitingas</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">12,347</span>
                    <span class="stat-label">narių</span>
                  </div>
                </div>
                <div class="program-action">
                  <button class="join-btn" data-program="fat-burn">Prisijungti - €47/mėn</button>
                </div>
              </div>
            </div>

            <div class="program-card" data-level="intermediate">
              <div class="program-header" style="background: linear-gradient(135deg, #39ff14, #00d4ff);">
                <div class="program-icon">💪</div>
              </div>
              <div class="program-body">
                <h3 class="program-title">Muscle Builder Pro</h3>
                <p class="program-description">
                  16 savaičių raumenų masės auginimo programa. Progressive overload + optimal recovery + high-protein nutrition.
                </p>
                <div class="program-stats">
                  <div class="program-stat">
                    <span class="stat-value">16</span>
                    <span class="stat-label">savaičių</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">4.9★</span>
                    <span class="stat-label">reitingas</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">8,921</span>
                    <span class="stat-label">narių</span>
                  </div>
                </div>
                <div class="program-action">
                  <button class="join-btn" data-program="muscle-builder">Prisijungti - €67/mėn</button>
                </div>
              </div>
            </div>

            <div class="program-card" data-level="advanced">
              <div class="program-header" style="background: linear-gradient(135deg, #ff4500, #ff1493);">
                <div class="program-icon">⚡</div>
              </div>
              <div class="program-body">
                <h3 class="program-title">Elite Performance</h3>
                <p class="program-description">
                  20 savaičių elito programa atletų lygiui. Advanced periodization + sports nutrition + recovery protocols.
                </p>
                <div class="program-stats">
                  <div class="program-stat">
                    <span class="stat-value">20</span>
                    <span class="stat-label">savaičių</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">5.0★</span>
                    <span class="stat-label">reitingas</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">1,247</span>
                    <span class="stat-label">narių</span>
                  </div>
                </div>
                <div class="program-action">
                  <button class="join-btn" data-program="elite">Prisijungti - €127/mėn</button>
                </div>
              </div>
            </div>

            <div class="program-card" data-level="beginner">
              <div class="program-header" style="background: linear-gradient(135deg, #8a2be2, #ff1493);">
                <div class="program-icon">🧘</div>
              </div>
              <div class="program-body">
                <h3 class="program-title">Mindful Movement</h3>
                <p class="program-description">
                  8 savaičių yoga + mindfulness + gentle strength programa. Idealus streso mažinimui ir lankstumui.
                </p>
                <div class="program-stats">
                  <div class="program-stat">
                    <span class="stat-value">8</span>
                    <span class="stat-label">savaičių</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">4.7★</span>
                    <span class="stat-label">reitingas</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">5,683</span>
                    <span class="stat-label">narių</span>
                  </div>
                </div>
                <div class="program-action">
                  <button class="join-btn" data-program="mindful">Prisijungti - €27/mėn</button>
                </div>
              </div>
            </div>

            <div class="program-card" data-level="intermediate">
              <div class="program-header" style="background: linear-gradient(135deg, #ffd700, #ff4500);">
                <div class="program-icon">🥑</div>
              </div>
              <div class="program-body">
                <h3 class="program-title">Keto Transformation</h3>
                <p class="program-description">
                  10 savaičių ketogeninė programa su AI meal planning. Fat adaptation + optimal ketosis + energy boost.
                </p>
                <div class="program-stats">
                  <div class="program-stat">
                    <span class="stat-value">10</span>
                    <span class="stat-label">savaičių</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">4.6★</span>
                    <span class="stat-label">reitingas</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">3,492</span>
                    <span class="stat-label">narių</span>
                  </div>
                </div>
                <div class="program-action">
                  <button class="join-btn" data-program="keto">Prisijungti - €57/mėn</button>
                </div>
              </div>
            </div>

            <div class="program-card" data-level="advanced">
              <div class="program-header" style="background: linear-gradient(135deg, #000000, #8a2be2);">
                <div class="program-icon">🏆</div>
              </div>
              <div class="program-body">
                <h3 class="program-title">Competition Prep</h3>
                <p class="program-description">
                  24 savaičių programa bodybuilding varžyboms. Contest diet + peak conditioning + posing practice.
                </p>
                <div class="program-stats">
                  <div class="program-stat">
                    <span class="stat-value">24</span>
                    <span class="stat-label">savaičių</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">4.9★</span>
                    <span class="stat-label">reitingas</span>
                  </div>
                  <div class="program-stat">
                    <span class="stat-value">847</span>
                    <span class="stat-label">narių</span>
                  </div>
                </div>
                <div class="program-action">
                  <button class="join-btn" data-program="competition">Prisijungti - €197/mėn</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Program Benefits -->
          <div class="info-box">
            <h3 style="margin-bottom: 20px; color: var(--accent-electric);">✨ Kas įeina į kiekvieną programą:</h3>
            <div class="options-grid">
              <div style="text-align: center;">
                <div style="font-size: 32px; margin-bottom: 12px;">📱</div>
                <div style="font-weight: 600; margin-bottom: 8px;">AI treneris 24/7</div>
                <div style="color: var(--text-secondary); font-size: 12px;">Personalizuotos rekomendacijos ir real-time feedback</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 32px; margin-bottom: 12px;">🍽️</div>
                <div style="font-weight: 600; margin-bottom: 8px;">Mitybos planas</div>
                <div style="color: var(--text-secondary); font-size: 12px;">Skanūs receptai ir automatinis grocery list</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 32px; margin-bottom: 12px;">👥</div>
                <div style="font-weight: 600; margin-bottom: 8px;">Community palaikymas</div>
                <div style="color: var(--text-secondary); font-size: 12px;">Private Discord kanale su bendraminčiais</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 32px; margin-bottom: 12px;">📊</div>
                <div style="font-weight: 600; margin-bottom: 8px;">Pažangos sekimas</div>
                <div style="color: var(--text-secondary); font-size: 12px;">Detalūs grafikai ir AI analizė</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 32px; margin-bottom: 12px;">💰</div>
                <div style="font-weight: 600; margin-bottom: 8px;">Money-back garantija</div>
                <div style="color: var(--text-secondary); font-size: 12px;">30 dienų grąžinimas jei nepatinka</div>
              </div>
              <div style="text-align: center;">
                <div style="font-size: 32px; margin-bottom: 12px;">🏅</div>
                <div style="font-weight: 600; margin-bottom: 8px;">Sertifikatas</div>
                <div style="color: var(--text-secondary); font-size: 12px;">Oficialus FitAI Pro completion certificate</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Other sections with construction placeholders -->
        <div class="section" id="workouts">
          <div class="dashboard-header">
            <h1 class="section-title">Treniruotės</h1>
            <p class="section-subtitle">Jūsų personalizuotos treniruočių programos</p>
          </div>
          <div class="construction-placeholder">
            <div class="construction-icon">🚧</div>
            <h3 class="construction-title">Sekcija kuriama</h3>
            <p class="construction-desc">Čia bus jūsų treniruočių planas, video instruktažai ir pažangos sekimas</p>
          </div>
        </div>

        <div class="section" id="nutrition">
          <div class="dashboard-header">
            <h1 class="section-title">Mityba</h1>
            <p class="section-subtitle">Išmanioji mitybos analizė ir planavimas</p>
          </div>
          <div class="construction-placeholder">
            <div class="construction-icon">🚧</div>
            <h3 class="construction-title">Sekcija kuriama</h3>
            <p class="construction-desc">Čia bus foto maisto analizė, receptai ir AI meal planning</p>
          </div>
        </div>

        <div class="section" id="progress">
          <div class="dashboard-header">
            <h1 class="section-title">Pažanga</h1>
            <p class="section-subtitle">Jūsų transformacijos kelionės analizė</p>
          </div>
          <div class="construction-placeholder">
            <div class="construction-icon">🚧</div>
            <h3 class="construction-title">Sekcija kuriama</h3>
            <p class="construction-desc">Čia bus svorio grafikai, progress photos ir AI analizė</p>
          </div>
        </div>

        <div class="section" id="ai-coach">
          <div class="dashboard-header">
            <h1 class="section-title">AI Treneris</h1>
            <p class="section-subtitle">Personalus dirbtinio intelekto treneris 24/7</p>
          </div>
          <div class="construction-placeholder">
            <div class="construction-icon">🚧</div>
            <h3 class="construction-title">Sekcija kuriama</h3>
            <p class="construction-desc">Čia bus AI form analysis, real-time coaching ir personalized tips</p>
          </div>
        </div>

        <div class="section" id="meal-planning">
          <div class="dashboard-header">
            <h1 class="section-title">Patiekalų planavimas</h1>
            <p class="section-subtitle">AI kuriami personalizuoti valgiaraščiai</p>
          </div>
          <div class="construction-placeholder">
            <div class="construction-icon">🚧</div>
            <h3 class="construction-title">Sekcija kuriama</h3>
            <p class="construction-desc">Čia bus automatinis meal planning, grocery lists ir AI receptai</p>
          </div>
        </div>

        <div class="section" id="body-analysis">
          <div class="dashboard-header">
            <h1 class="section-title">Kūno analizė</h1>
            <p class="section-subtitle">3D kūno skenavimas ir pažangos stebėjimas</p>
          </div>
          <div class="construction-placeholder">
            <div class="construction-icon">🚧</div>
            <h3 class="construction-title">Sekcija kuriama</h3>
            <p class="construction-desc">Čia bus 3D body scanning, progress photos AI analysis ir measurements</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat Overlay -->
  <div class="chat-overlay" id="chatOverlay"></div>

  <!-- Chat Container -->
  <div class="chat-container" id="chatContainer">
    <div class="chat-header">
      <div class="chat-title">🤖 AI Fitness Ekspertas</div>
      <button class="chat-close" id="chatClose">×</button>
    </div>
    <div class="chat-messages" id="chatMessages">
      <div class="message ai">
        <div class="message-avatar">AI</div>
        <div class="message-content">
          Sveiki! Esu jūsų AI fitness ekspertas. Galiu padėti planuoti treniruotes, analizuoti mitybą, sekti pažangą ir optimizuoti rezultatus. Kaip galiu padėti?
        </div>
      </div>
    </div>
    <div class="chat-input">
      <div class="input-group">
        <textarea 
          class="message-input" 
          id="messageInput" 
          placeholder="Klauskit apie treniruotes, mitybą, pažangą..."
          rows="1"
        ></textarea>
        <button class="send-btn" id="sendBtn">→</button>
      </div>
    </div>
  </div>

  <!-- Floating Chat Button -->
  <button class="chat-trigger" id="chatTrigger">💬</button>

  <!-- Achievement Popup -->
  <div class="achievement-popup" id="achievementPopup">
    <div class="achievement-content">
      <div class="achievement-icon">🏆</div>
      <div class="achievement-text">
        <div class="achievement-title">Pasiekimas atrakinta!</div>
        <div class="achievement-desc">+50 taškų už užduoties įvykdymą</div>
      </div>
    </div>
  </div>

  <script>
    // Global state
    let currentSection = 'dashboard';
    let currentStep = 1;
    let totalSteps = 6;
    let userData = {};
    let userStats = {
      weight: 78.2,
      targetWeight: 72,
      weeklyWorkouts: 4,
      totalWorkouts: 47,
      todayCalories: 1847,
      targetCalories: 2300,
      sleepHours: 8.2,
      userPoints: 1247,
      completedTasks: []
    };

    // Onboarding data
    let onboardingData = {
      name: '',
      age: '',
      gender: '',
      height: '',
      weight: '',
      goal: '',
      targetWeight: '',
      activityLevel: '',
      workoutFrequency: 3,
      dietStyle: '',
      mealsPerDay: 5,
      allergies: ''
    };

    // DOM elements
    const onboardingOverlay = document.getElementById('onboardingOverlay');
    const startOverBtn = document.getElementById('startOverBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const wizardProgress = document.getElementById('wizardProgress');
    const chatTrigger = document.getElementById('chatTrigger');
    const chatContainer = document.getElementById('chatContainer');
    const chatOverlay = document.getElementById('chatOverlay');
    const chatClose = document.getElementById('chatClose');
    const chatMessages = document.getElementById('chatMessages');
    const messageInput = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');
    const achievementPopup = document.getElementById('achievementPopup');
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    const sidebarOverlay = document.getElementById('sidebarOverlay');

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      console.log('🚀 FitAI Pro inicializuojama...');
      
      // Check if user has completed onboarding
      const hasCompletedOnboarding = localStorage.getItem('fitai_onboarding_completed');
      if (!hasCompletedOnboarding) {
        showOnboarding();
      } else {
        loadUserData();
      }

      // Initialize all components
      initializeNavigation();
      initializeOnboarding();
      initializeChat();
      initializeMobileMenu();
      initializeInteractiveFeatures();
      initializeProgramFilters();
      
      // Ensure dashboard is visible initially
      const dashboardSection = document.getElementById('dashboard');
      if (dashboardSection) {
        dashboardSection.classList.add('active');
        dashboardSection.style.display = 'block';
      }
      
      // Hide other sections initially
      document.querySelectorAll('.section:not(#dashboard)').forEach(section => {
        section.classList.remove('active');
        section.style.display = 'none';
      });
      
      updateAllUIElements();
      
      // Initialize charts after a delay to ensure DOM is ready
      setTimeout(() => {
        console.log('Initializing dashboard charts...');
        initializeChartsForSection('dashboard');
      }, 1000);
      
      console.log('✅ FitAI Pro sėkmingai paleista!');
    });

    // Mobile menu functionality
    function initializeMobileMenu() {
      if (!menuToggle || !sidebar || !sidebarOverlay) return;
      
      menuToggle.addEventListener('click', function() {
        sidebar.classList.toggle('active');
        sidebarOverlay.classList.toggle('active');
      });

      sidebarOverlay.addEventListener('click', function() {
        sidebar.classList.remove('active');
        sidebarOverlay.classList.remove('active');
      });

      // Close mobile menu when nav item is clicked
      document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
          if (window.innerWidth <= 768) {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
          }
        });
      });
    }

    // Onboarding functionality
    function initializeOnboarding() {
      if (!prevBtn || !nextBtn) return;

      prevBtn.addEventListener('click', function() {
        if (currentStep > 1) {
          currentStep--;
          updateWizardStep();
        }
      });

      nextBtn.addEventListener('click', function() {
        if (validateCurrentStep()) {
          if (currentStep < totalSteps) {
            currentStep++;
            updateWizardStep();
          } else {
            completeOnboarding();
          }
        }
      });

      // Option card selection
      document.addEventListener('click', function(e) {
        if (e.target.closest('.option-card')) {
          const card = e.target.closest('.option-card');
          const container = card.parentElement;
          
          // Remove selection from siblings
          container.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
          
          // Add selection to clicked card
          card.classList.add('selected');
        }
      });

      // Start over functionality
      if (startOverBtn) {
        startOverBtn.addEventListener('click', function() {
          if (confirm('Ar tikrai norite pradėti iš naujo? Visi duomenys bus ištrinti.')) {
            resetAllData();
            showOnboarding();
          }
        });
      }
    }

    function showOnboarding() {
      if (onboardingOverlay) {
        onboardingOverlay.classList.add('active');
        currentStep = 1;
        updateWizardStep();
      }
    }

    function hideOnboarding() {
      if (onboardingOverlay) {
        onboardingOverlay.classList.remove('active');
        localStorage.setItem('fitai_onboarding_completed', 'true');
        saveUserData();
      }
    }

    function updateWizardStep() {
      if (!wizardProgress) return;
      
      // Update progress bar
      const progress = (currentStep / totalSteps) * 100;
      wizardProgress.style.width = progress + '%';
      
      // Update step indicators
      document.querySelectorAll('.step').forEach((step, index) => {
        const stepNum = index + 1;
        step.classList.remove('active', 'completed');
        if (stepNum === currentStep) {
          step.classList.add('active');
        } else if (stepNum < currentStep) {
          step.classList.add('completed');
        }
      });
      
      // Show current step
      document.querySelectorAll('.wizard-step').forEach((step, index) => {
        step.classList.remove('active');
        if (index + 1 === currentStep) {
          step.classList.add('active');
        }
      });
      
      // Update buttons
      if (prevBtn) prevBtn.disabled = currentStep === 1;
      if (nextBtn) {
        if (currentStep === totalSteps) {
          nextBtn.textContent = 'Baigti';
        } else {
          nextBtn.textContent = 'Toliau';
        }
      }
      
      // Update plan summary on last step
      if (currentStep === totalSteps) {
        updatePlanSummary();
      }
    }

    function updatePlanSummary() {
      const summary = document.getElementById('planSummary');
      if (!summary) return;
      
      const goalText = {
        'lose_weight': 'svorio metimas',
        'gain_muscle': 'raumenų auginimas', 
        'get_fit': 'fizinio pajėgumo gerinimas',
        'maintain': 'formos palaikymas'
      };
      
      const activityText = {
        'sedentary': 'mažo aktyvumo',
        'light': 'lengvo aktyvumo',
        'moderate': 'vidutinio aktyvumo', 
        'active': 'aukšto aktyvumo'
      };
      
      summary.innerHTML = `
        <strong>${onboardingData.name || 'Vartotojas'}</strong>, ${onboardingData.age || '?'} m., tikslas: <strong>${goalText[onboardingData.goal] || 'nepasirinkta'}</strong><br>
        Dabartinis svoris: <strong>${onboardingData.weight || '?'}kg</strong>, tikslas: <strong>${onboardingData.targetWeight || 'nenustatytas'}kg</strong><br>
        Treniruotės: <strong>${onboardingData.workoutFrequency || 3}x/savaitę</strong>, lygis: <strong>${activityText[onboardingData.activityLevel] || 'nenustatytas'}</strong><br>
        Mityba: <strong>${onboardingData.dietStyle || 'įprasta'}</strong>, valgymų: <strong>${onboardingData.mealsPerDay || 5}x/dieną</strong>
      `;
    }

    function validateCurrentStep() {
      try {
        switch(currentStep) {
          case 2:
            const name = document.getElementById('userName')?.value?.trim();
            const age = document.getElementById('userAge')?.value;
            const height = document.getElementById('userHeight')?.value;
            const weight = document.getElementById('userWeight')?.value;
            const gender = document.querySelector('.option-card.selected[data-value]')?.dataset?.value;
            
            if (!name || !age || !height || !weight || !gender) {
              alert('Prašome užpildyti visus laukus');
              return false;
            }
            
            onboardingData.name = name;
            onboardingData.age = age;
            onboardingData.height = height;
            onboardingData.weight = weight;
            onboardingData.gender = gender;
            break;
            
          case 3:
            const goal = document.querySelector('.option-card.selected[data-value]')?.dataset?.value;
            const targetWeight = document.getElementById('targetWeight')?.value;
            
            if (!goal) {
              alert('Prašome pasirinkti tikslą');
              return false;
            }
            
            onboardingData.goal = goal;
            onboardingData.targetWeight = targetWeight;
            break;
            
          case 4:
            const activityLevel = document.querySelector('.option-card.selected[data-value]')?.dataset?.value;
            const workoutFrequency = document.getElementById('workoutFrequency')?.value;
            
            if (!activityLevel) {
              alert('Prašome pasirinkti aktyvumo lygį');
              return false;
            }
            
            onboardingData.activityLevel = activityLevel;
            onboardingData.workoutFrequency = workoutFrequency;
            break;
            
          case 5:
            const dietStyle = document.querySelector('.option-card.selected[data-value]')?.dataset?.value;
            const mealsPerDay = document.getElementById('mealsPerDay')?.value;
            const allergies = document.getElementById('allergies')?.value;
            
            if (!dietStyle) {
              alert('Prašome pasirinkti mitybos stilių');
              return false;
            }
            
            onboardingData.dietStyle = dietStyle;
            onboardingData.mealsPerDay = mealsPerDay;
            onboardingData.allergies = allergies;
            break;
        }
        return true;
      } catch (error) {
        console.error('Validation error:', error);
        return false;
      }
    }

    function completeOnboarding() {
      try {
        // Save all onboarding data
        userData = { ...onboardingData };
        userStats.weight = parseFloat(onboardingData.weight) || userStats.weight;
        if (onboardingData.targetWeight) {
          userStats.targetWeight = parseFloat(onboardingData.targetWeight);
        }
        
        hideOnboarding();
        updateAllUIElements();
        showAchievement('Sveiki atvykę!', 'Sėkmingai užpildėte profilį. +100 taškų!');
        userStats.userPoints += 100;
        saveUserData();
      } catch (error) {
        console.error('Onboarding completion error:', error);
      }
    }

    function resetAllData() {
      localStorage.removeItem('fitai_onboarding_completed');
      localStorage.removeItem('fitai_user_data');
      localStorage.removeItem('fitai_user_stats');
      onboardingData = {
        name: '', age: '', gender: '', height: '', weight: '', goal: '',
        targetWeight: '', activityLevel: '', workoutFrequency: 3,
        dietStyle: '', mealsPerDay: 5, allergies: ''
      };
      userStats = {
        weight: 78.2, targetWeight: 72, weeklyWorkouts: 4, totalWorkouts: 47,
        todayCalories: 1847, targetCalories: 2300, sleepHours: 8.2,
        userPoints: 0, completedTasks: []
      };
      userData = {};
    }

    // Navigation functionality
    function initializeNavigation() {
      document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
          try {
            // Remove active from all nav items
            document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
            this.classList.add('active');
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            
            // Show selected section
            const sectionId = this.dataset.section;
            const section = document.getElementById(sectionId);
            if (section) {
              section.classList.add('active');
              currentSection = sectionId;
              
              // Initialize charts for the section after delay
              setTimeout(() => {
                initializeChartsForSection(sectionId);
              }, 100);
            }
          } catch (error) {
            console.error('Navigation error:', error);
          }
        });
      });
    }

    // Chart functionality
    function initializeChartsForSection(sectionId) {
      try {
        switch(sectionId) {
          case 'dashboard':
            createDonutChart('macrosChart', [45, 30, 25], ['#00d4ff', '#39ff14', '#ff4500']);
            createDonutChart('bodyCompositionChart', [67, 18, 15], ['#8a2be2', '#ff1493', '#666666']);
            break;
          case 'analytics':
            createDonutChart('weightTrendChart', [78, 22], ['#39ff14', '#00d4ff']);
            createDonutChart('sleepAnalysisChart', [65, 25, 10], ['#8a2be2', '#00d4ff', '#ff4500']);
            break;
        }
      } catch (error) {
        console.error('Chart initialization error:', error);
      }
    }

    function createDonutChart(canvasId, data, colors) {
      try {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;
        
        const ctx = canvas.getContext('2d');
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        const outerRadius = Math.min(canvas.width, canvas.height) / 2 - 20;
        const innerRadius = outerRadius * 0.6;
        
        // Clear canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        let currentAngle = -Math.PI / 2; // Start from top
        const total = data.reduce((sum, value) => sum + value, 0);
        
        data.forEach((value, index) => {
          const sliceAngle = (value / total) * 2 * Math.PI;
          
          // Draw slice
          ctx.beginPath();
          ctx.arc(centerX, centerY, outerRadius, currentAngle, currentAngle + sliceAngle);
          ctx.arc(centerX, centerY, innerRadius, currentAngle + sliceAngle, currentAngle, true);
          ctx.closePath();
          ctx.fillStyle = colors[index % colors.length];
          ctx.fill();
          
          currentAngle += sliceAngle;
        });
      } catch (error) {
        console.error('Chart creation error:', error);
      }
    }

    // Interactive dashboard functions
    function initializeInteractiveFeatures() {
      // Dashboard card clicks
      document.querySelectorAll('.dashboard-card').forEach(card => {
        card.addEventListener('click', function() {
          try {
            const action = this.dataset.action;
            if (action) {
              switch(action) {
                case 'weight': updateWeight(); break;
                case 'workout': logWorkout(); break;
                case 'meal': logMeal(); break;
                case 'sleep': updateSleep(); break;
              }
            }
          } catch (error) {
            console.error('Dashboard card error:', error);
          }
        });
      });

      // Task completion buttons
      document.querySelectorAll('.complete-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.stopPropagation();
          try {
            const taskId = this.dataset.task;
            if (taskId) {
              completeTask(taskId);
            }
          } catch (error) {
            console.error('Task completion error:', error);
          }
        });
      });

      // Program join buttons
      document.querySelectorAll('.join-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.stopPropagation();
          try {
            const programId = this.dataset.program;
            if (programId) {
              joinProgram(programId);
            }
          } catch (error) {
            console.error('Program join error:', error);
          }
        });
      });
    }

    function updateWeight() {
      try {
        const newWeight = prompt('Įveskite dabartinį svorį (kg):', userStats.weight);
        if (newWeight && !isNaN(newWeight) && newWeight > 0) {
          const previousWeight = userStats.weight;
          userStats.weight = parseFloat(newWeight);
          
          const weightElement = document.getElementById('currentWeight');
          if (weightElement) {
            weightElement.textContent = `${userStats.weight}kg`;
          }
          
          const change = userStats.weight - previousWeight;
          const changeElement = weightElement?.parentElement?.querySelector('.card-change');
          if (changeElement) {
            if (change < 0) {
              changeElement.innerHTML = `<span>↘</span><span>${change.toFixed(1)}kg šią savaitę</span>`;
              changeElement.className = 'card-change positive';
              showAchievement('Svoris atnaujintas!', `${change.toFixed(1)}kg pokytis įrašytas`);
            } else if (change > 0) {
              changeElement.innerHTML = `<span>↗</span><span>+${change.toFixed(1)}kg šią savaitę</span>`;
              changeElement.className = 'card-change negative';
            }
          }
          
          saveUserData();
        }
      } catch (error) {
        console.error('Weight update error:', error);
      }
    }

    function logWorkout() {
      try {
        const workoutType = prompt('Kokią treniruotę atlikote?', 'Push Day');
        if (workoutType) {
          userStats.weeklyWorkouts++;
          userStats.totalWorkouts++;
          
          const workoutElement = document.getElementById('weeklyWorkouts');
          if (workoutElement) {
            workoutElement.textContent = `${userStats.weeklyWorkouts}/5`;
          }
          
          showAchievement('Treniruotė įrašyta!', `${workoutType} pridėta į žurnalą. +25 taškų!`);
          userStats.userPoints += 25;
          
          saveUserData();
          updateAllUIElements();
        }
      } catch (error) {
        console.error('Workout log error:', error);
      }
    }

    function logMeal() {
      try {
        const calories = prompt('Kiek kalorijų suvartojote?', '300');
        if (calories && !isNaN(calories) && calories > 0) {
          userStats.todayCalories += parseInt(calories);
          
          const caloriesElement = document.getElementById('todayCalories');
          if (caloriesElement) {
            caloriesElement.textContent = userStats.todayCalories.toLocaleString();
          }
          
          const remaining = userStats.targetCalories - userStats.todayCalories;
          const changeElement = caloriesElement?.parentElement?.querySelector('.card-change');
          if (changeElement) {
            changeElement.innerHTML = `<span>📊</span><span>${remaining > 0 ? '-' + remaining : 'Viršytas ' + Math.abs(remaining)} iki tikslo</span>`;
          }
          
          showAchievement('Maistas įrašytas!', `+${calories} kalorijų pridėta. +10 taškų!`);
          userStats.userPoints += 10;
          
          saveUserData();
        }
      } catch (error) {
        console.error('Meal log error:', error);
      }
    }

    function updateSleep() {
      try {
        const hours = prompt('Kiek valandų miegojote?', '8');
        if (hours && !isNaN(hours) && hours > 0 && hours <= 24) {
          userStats.sleepHours = parseFloat(hours);
          
          const sleepElement = document.getElementById('sleepQuality');
          if (sleepElement) {
            sleepElement.textContent = `${userStats.sleepHours}h`;
          }
          
          let quality = 'Gerai';
          if (userStats.sleepHours >= 8) quality = 'Puikiai';
          if (userStats.sleepHours < 6) quality = 'Per mažai';
          
          showAchievement('Miegas įrašytas!', `${userStats.sleepHours}h - ${quality}! +15 taškų!`);
          userStats.userPoints += 15;
          
          saveUserData();
        }
      } catch (error) {
        console.error('Sleep update error:', error);
      }
    }

    // Task completion system
    function completeTask(taskId) {
      try {
        if (userStats.completedTasks.includes(taskId)) return;
        
        const taskCard = document.getElementById(`task-${taskId}`);
        const progressBar = document.getElementById(`${taskId}ProgressBar`);
        const progressText = document.getElementById(`${taskId}Progress`);
        
        let points = 0;
        let message = '';
        
        switch(taskId) {
          case 'workout':
            userStats.weeklyWorkouts++;
            userStats.totalWorkouts++;
            points = 50;
            message = 'Treniruotė baigta!';
            if (progressBar) progressBar.style.width = '100%';
            if (progressText) progressText.textContent = '10/10 pratimų';
            break;
            
          case 'nutrition':
            points = 30;
            message = 'Baltymų tikslas pasiektas!';
            if (progressBar) progressBar.style.width = '100%';
            if (progressText) progressText.textContent = '150/150g';
            break;
            
          case 'water':
            points = 20;
            message = 'Vandens tikslas pasiektas!';
            if (progressBar) progressBar.style.width = '100%';
            if (progressText) progressText.textContent = '2.5/2.5L';
            break;
        }
        
        // Mark task as completed
        if (taskCard) {
          taskCard.classList.add('completed');
          const btn = taskCard.querySelector('.complete-btn');
          if (btn) {
            btn.textContent = 'Atlikta ✅';
            btn.disabled = true;
          }
        }
        
        // Add points
        userStats.userPoints += points;
        userStats.completedTasks.push(taskId);
        
        // Update badge
        updateTaskBadge();
        
        // Show achievement
        showAchievement(message, `+${points} taškų!`);
        
        // Save data
        saveUserData();
        updateAllUIElements();
      } catch (error) {
        console.error('Task completion error:', error);
      }
    }

    function updateTaskBadge() {
      try {
        const badge = document.getElementById('taskBadge');
        if (badge) {
          const remainingTasks = Math.max(0, 3 - userStats.completedTasks.length);
          badge.textContent = remainingTasks;
          badge.style.display = remainingTasks > 0 ? 'block' : 'none';
        }
      } catch (error) {
        console.error('Task badge update error:', error);
      }
    }

    // Program functionality
    function joinProgram(programId) {
      try {
        const programs = {
          'fat-burn': 'Fat Burn Revolution',
          'muscle-builder': 'Muscle Builder Pro',
          'elite': 'Elite Performance',
          'mindful': 'Mindful Movement',
          'keto': 'Keto Transformation',
          'competition': 'Competition Prep'
        };
        
        const programName = programs[programId];
        if (programName && confirm(`Ar norite prisijungti prie "${programName}" programos?`)) {
          showAchievement('Programa pradėta!', `Sėkmingai prisijungėte prie ${programName}!`);
          userStats.userPoints += 100;
          saveUserData();
        }
      } catch (error) {
        console.error('Program join error:', error);
      }
    }

    // Program filter functionality
    function initializeProgramFilters() {
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('program-filter')) {
          try {
            // Update filter buttons
            document.querySelectorAll('.program-filter').forEach(btn => {
              btn.classList.remove('active');
            });
            e.target.classList.add('active');
            
            // Filter programs
            const filter = e.target.dataset.filter;
            document.querySelectorAll('.program-card').forEach(card => {
              if (filter === 'all' || card.dataset.level === filter) {
                card.style.display = 'block';
              } else {
                card.style.display = 'none';
              }
            });
          } catch (error) {
            console.error('Program filter error:', error);
          }
        }
      });
    }

    // Chat functionality
    function initializeChat() {
      if (!chatTrigger || !chatContainer || !chatOverlay || !chatClose) return;

      chatTrigger.addEventListener('click', function() {
        chatContainer.classList.add('active');
        chatOverlay.classList.add('active');
        chatTrigger.style.display = 'none';
      });

      chatClose.addEventListener('click', closeChat);
      chatOverlay.addEventListener('click', closeChat);

      if (sendBtn) sendBtn.addEventListener('click', sendMessage);
      
      if (messageInput) {
        messageInput.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
          }
        });

        messageInput.addEventListener('input', function() {
          this.style.height = 'auto';
          this.style.height = Math.min(this.scrollHeight, 80) + 'px';
        });
      }
    }

    function closeChat() {
      if (chatContainer && chatOverlay && chatTrigger) {
        chatContainer.classList.remove('active');
        chatOverlay.classList.remove('active');
        chatTrigger.style.display = 'flex';
      }
    }

    function sendMessage() {
      try {
        if (!messageInput) return;
        
        const message = messageInput.value.trim();
        if (!message) return;
        
        addChatMessage(message, true);
        messageInput.value = '';
        messageInput.style.height = 'auto';
        
        setTimeout(() => {
          const response = generateAIResponse(message);
          addChatMessage(response, false);
        }, 1000 + Math.random() * 1000);
      } catch (error) {
        console.error('Send message error:', error);
      }
    }

    function addChatMessage(content, isUser = false) {
      try {
        if (!chatMessages) return;
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
        
        const avatar = isUser ? (userData.name ? userData.name.charAt(0).toUpperCase() : 'U') : 'AI';
        
        messageDiv.innerHTML = `
          <div class="message-avatar">${avatar}</div>
          <div class="message-content">${content}</div>
        `;
        
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      } catch (error) {
        console.error('Add chat message error:', error);
      }
    }

    function generateAIResponse(message) {
      try {
        const msg = message.toLowerCase();
        const name = userData.name || 'draugas';
        
        if (msg.includes('treniruot') || msg.includes('sportu')) {
          return `Labai gerai, ${name}! Analizuoju jūsų dabartinę treniruočių programą. Rekomenduoju:
          <br><br>• Šią savaitę atlikote ${userStats.weeklyWorkouts}/5 treniruočių
          <br>• Kitas treniruotė: Push Day (krūtinė + pečiai)
          <br>• Pamėginkite padidinti bench press svorį 2.5kg
          <br><br>Ar norėtumėte detalesnę šiandien treniruotę?`;
        }
        
        if (msg.includes('mityb') || msg.includes('valgym') || msg.includes('kalor')) {
          return `Puiku, ${name}! Jūsų šiandienos mityba:
          <br><br>• Suvartota: ${userStats.todayCalories.toLocaleString()} kalorijų
          <br>• Liko: ${Math.max(0, userStats.targetCalories - userStats.todayCalories)} iki tikslo
          <br>• Rekomenduoju pridėti daugiau baltymų
          <br><br>Ar norite, kad sugeneruočiau rytdienos valgiaraštį?`;
        }
        
        if (msg.includes('svori') || msg.includes('numest') || msg.includes('kg')) {
          const weightChange = userStats.targetWeight ? userStats.weight - userStats.targetWeight : 0;
          return `${name}, jūsų svorio pažanga:
          <br><br>• Dabartinis svoris: ${userStats.weight}kg
          <br>• Tikslas: ${userStats.targetWeight || 'nenustatytas'}kg
          <br>• Liko: ${weightChange > 0 ? weightChange.toFixed(1) + 'kg' : 'Tikslas pasiektas!'}
          <br><br>Jūsų tempas yra puikus! Tęskite šį planą.`;
        }
        
        if (msg.includes('taš') || msg.includes('point') || msg.includes('lygis')) {
          return `Jūsų pasiekimai, ${name}:
          <br><br>• Taškai: ${userStats.userPoints.toLocaleString()}
          <br>• Atliktos užduotys: ${userStats.completedTasks.length}/3 šiandien
          <br>• Bendras treniruočių: ${userStats.totalWorkouts}
          <br><br>Puikiai sekasi! Dar ${Math.max(0, 3 - userStats.completedTasks.length)} užduotys likusios šiandien.`;
        }
        
        const responses = [
          `Kaip jūsų AI treneris, ${name}, matau kad puikiai sekasi! Šiandien atlikote ${userStats.completedTasks.length}/3 užduočių. Ko norėtumėte pasiekti?`,
          `Sveiki, ${name}! Jūsų šiandienos statistika atrodo gerai. Miego kokybė ${userStats.sleepHours}h - tai puikus pagrindas produktyviai dienai!`,
          `${name}, pastebiu kad sistemingai gerinsite savo rezultatus. Jūsų pastovumas yra raktas į sėkmę. Kaip šiandien jaučiatės?`
        ];
        
        return responses[Math.floor(Math.random() * responses.length)];
      } catch (error) {
        console.error('AI response generation error:', error);
        return 'Atsiprašau, įvyko klaida. Pabandykite dar kartą.';
      }
    }

    // Achievement system
    function showAchievement(title, description) {
      try {
        if (!achievementPopup) return;
        
        const titleElement = achievementPopup.querySelector('.achievement-title');
        const descElement = achievementPopup.querySelector('.achievement-desc');
        
        if (titleElement) titleElement.textContent = title;
        if (descElement) descElement.textContent = description;
        
        achievementPopup.classList.add('show');
        
        setTimeout(() => {
          achievementPopup.classList.remove('show');
        }, 4000);
      } catch (error) {
        console.error('Achievement show error:', error);
      }
    }

    // Data persistence
    function saveUserData() {
      try {
        localStorage.setItem('fitai_user_data', JSON.stringify(userData));
        localStorage.setItem('fitai_user_stats', JSON.stringify(userStats));
      } catch (error) {
        console.error('Save data error:', error);
      }
    }

    function loadUserData() {
      try {
        const savedUserData = localStorage.getItem('fitai_user_data');
        const savedUserStats = localStorage.getItem('fitai_user_stats');
        
        if (savedUserData) {
          userData = JSON.parse(savedUserData);
        }
        
        if (savedUserStats) {
          userStats = { ...userStats, ...JSON.parse(savedUserStats) };
        }
        
        updateAllUIElements();
      } catch (error) {
        console.error('Load data error:', error);
      }
    }

    function updateAllUIElements() {
      try {
        // Update welcome text
        const welcomeElement = document.getElementById('welcomeText');
        const avatarElement = document.getElementById('userAvatar');
        
        if (userData.name) {
          if (welcomeElement) welcomeElement.textContent = `Sveiki, ${userData.name}`;
          if (avatarElement) avatarElement.textContent = userData.name.charAt(0).toUpperCase();
        }
        
        // Update dashboard values
        const elements = {
          'currentWeight': `${userStats.weight}kg`,
          'weeklyWorkouts': `${userStats.weeklyWorkouts}/5`,
          'todayCalories': userStats.todayCalories.toLocaleString(),
          'sleepQuality': `${userStats.sleepHours}h`
        };
        
        Object.entries(elements).forEach(([id, value]) => {
          const element = document.getElementById(id);
          if (element) element.textContent = value;
        });
        
        // Update task badge
        updateTaskBadge();
        
        // Update completed tasks
        userStats.completedTasks.forEach(taskId => {
          const taskCard = document.getElementById(`task-${taskId}`);
          if (taskCard) {
            taskCard.classList.add('completed');
            const btn = taskCard.querySelector('.complete-btn');
            if (btn) {
              btn.textContent = 'Atlikta ✅';
              btn.disabled = true;
            }
          }
        });
        
        // Update charts if on dashboard
        if (currentSection === 'dashboard') {
          setTimeout(() => {
            initializeChartsForSection('dashboard');
          }, 100);
        }
      } catch (error) {
        console.error('UI update error:', error);
      }
    }

    // Window resize handler for mobile
    window.addEventListener('resize', function() {
      if (window.innerWidth > 768) {
        if (sidebar) sidebar.classList.remove('active');
        if (sidebarOverlay) sidebarOverlay.classList.remove('active');
      }
    });

    console.log('🎯 FitAI Pro - Pilnavertė fitness platforma su AI paleista!');
  </script>

  <script>
/* ====== AI GLUE: saugus prisikabinimas prie esamo UI (be perrašymų) ====== */
(function(){
  if (window.__AI_GLUE_INSTALLED__) return; 
  window.__AI_GLUE_INSTALLED__ = true;

  const MODEL_PREFS = ['gpt-5-mini','gpt-4o-mini','gpt-4o'];

  async function askAIStream(message){
    // 1) bandome srautą su pirmu modeliu
    try {
      const model = MODEL_PREFS[0];
      const url = `/api/stream?model=${encodeURIComponent(model)}&message=${encodeURIComponent(message)}&chat_id=${Date.now()}&max_tokens=1024`;
      const res = await fetch(url, { headers: { Accept: 'text/event-stream' }});
      if (!res.ok || !res.body) throw new Error('no stream');

      const reader = res.body.getReader();
      const dec = new TextDecoder();
      let buf = '', out = '';

      for(;;){
        const it = await reader.read();
        if (it.done) break;
        buf += dec.decode(it.value, {stream:true});
        let i;
        while ((i = buf.indexOf('\n\n')) >= 0){
          const frame = buf.slice(0, i).trim(); 
          buf = buf.slice(i+2);
          if (!frame) continue;
          const line = frame.split('\n').find(l => l.startsWith('data:'));
          if (!line) continue;
          const payload = line.replace(/^data:\s*/,'').trim();
          if (payload === '[DONE]') break;
          try {
            const j = JSON.parse(payload);
            const piece = j?.choices?.[0]?.delta?.content || '';
            if (piece) out += piece;
          } catch(_){}
        }
      }
      if (out.trim()) return out;
      throw new Error('empty');
    } catch(_){
      // 2) fallback į /api/complete su kelių modelių sąrašu
      const r = await fetch('/api/complete', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message, models: MODEL_PREFS.join(','), max_tokens: 1024 })
      });
      const j = await r.json().catch(()=>({}));
      const ok = (j.answers||[]).find(a => a && a.text && !a.error);
      return ok?.text || j.text || 'Nepavyko gauti atsakymo.';
    }
  }

  async function genFlux(prompt){
    const r = await fetch('/api/flux/create', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ prompt, width:1024, height:1024 })
    });
    const j = await r.json().catch(()=>({}));
    if (j?.image) return j.image;
    throw new Error(j?.error || 'FLUX klaida');
  }

  // Paimam tavo elementus, jei yra:
  const input   = document.querySelector('#messageInput, [data-ai-input]');
  const sendBtn = document.querySelector('#sendBtn, [data-ai-send]');
  const box     = document.querySelector('#chatMessages, [data-ai-messages]');

  function addMsg(html, who='ai'){
    if (typeof window.addChatMessage === 'function') {
      window.addChatMessage(html, who === 'user');
      return;
    }
    // Minimalus fallback jeigu nėra tavo addChatMessage()
    const wrap = document.createElement('div');
    wrap.style.cssText = 'margin:10px 0;padding:10px;border:1px solid #333;border-radius:8px;background:#111;color:#fff';
    wrap.innerHTML = `<div style="opacity:.7;margin-bottom:6px">${who==='user'?'👤':'🤖'}</div>${html}`;
    (box || document.body).appendChild(wrap);
    if (box) box.scrollTop = box.scrollHeight;
  }

  async function handleSend(){
    let msg = (input?.value || '').trim();
    if (!msg && !input) { msg = prompt('Klausimas AI:') || ''; }
    if (!msg) return;

    addMsg(msg, 'user');
    if (input){ input.value=''; input.style.height='auto'; }

    // Jeigu prašoma vaizdo – FLUX
    if (/foto|nuotrauk|paveiksl|image|flux/i.test(msg)) {
      try {
        const url = await genFlux(msg.replace(/^(foto|image|paveikslas)[: ]*/i,''));
        addMsg(`<img src="${url}" alt="AI image" style="max-width:100%;border-radius:12px">`, 'ai');
        return;
      } catch(e){ addMsg('⚠️ Vaizdo generavimo klaida: ' + (e?.message||e), 'ai'); return; }
    }

    try {
      const text = await askAIStream(msg);
      addMsg(text, 'ai');
    } catch(e){
      addMsg('⚠️ Klaida: ' + (e?.message||e), 'ai');
    }
  }

  // ——— Saugiai perimam mygtuką/Enter (neperrašant tavo funkcijų)
  if (sendBtn) {
    sendBtn.addEventListener('click', function(e){
      e.preventDefault(); e.stopImmediatePropagation();
      handleSend();
    }, { capture:true });
  }
  if (input) {
    input.addEventListener('keydown', function(e){
      if (e.key === 'Enter' && !e.shiftKey){
        e.preventDefault(); e.stopImmediatePropagation();
        handleSend();
      }
    }, { capture:true });
  }
  // Mini mygtukas, jei puslapyje nėra tavo chat UI
  if (!sendBtn && !input) {
    const btn = document.createElement('button');
    btn.textContent = '💬';
    btn.title = 'AI';
    btn.style.cssText = 'position:fixed;right:16px;bottom:16px;width:50px;height:50px;border:none;border-radius:50%;background:#4b7;color:#fff;font-size:20px;box-shadow:0 8px 26px rgba(0,0,0,.35);z-index:9999;cursor:pointer';
    btn.onclick = handleSend;
    document.body.appendChild(btn);
  }
})();
</script>

</body>
</html>
