<!DOCTYPE html>
<html lang="lt" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ultimate Goal System - AI Vizijos į Realybę</title>
  
  <style>
/* =========================================================
   ULTIMATE DARK THEME SYSTEM
   ========================================================= */
:root {
  --bg-primary: #0a0a0b;
  --bg-secondary: #0f0f10;
  --bg-elevated: #141416;
  --bg-card: #1a1a1d;
  --bg-overlay: #1e1e22;
  --bg-glass: rgba(26, 26, 29, 0.8);
  
  --text-primary: #ffffff;
  --text-secondary: #b8bcc8;
  --text-muted: #8a8f9a;
  --text-hint: #6b7280;
  
  --border-soft: #2a2a2f;
  --border-medium: #374151;
  
  --accent-primary: #00ff88;
  --accent-primary-hover: #00e67a;
  --accent-secondary: #0099ff;
  --accent-ghost: rgba(0, 255, 136, 0.1);
  --accent-danger: #ff4757;
  --accent-warning: #ffa502;
  
  --success: #00ff88;
  --warning: #ffa502;
  --error: #ff4757;
  --info: #0099ff;
  
  --neu-raise: 
    0 8px 16px rgba(0, 0, 0, 0.4), 
    0 4px 8px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.03);
  
  --neu-press: 
    inset 0 4px 8px rgba(0, 0, 0, 0.6),
    inset 0 2px 4px rgba(0, 0, 0, 0.4);
  
  --neu-float: 
    0 20px 40px rgba(0, 0, 0, 0.6), 
    0 8px 16px rgba(0, 0, 0, 0.4);
  
  --glow-green: 0 0 20px rgba(0, 255, 136, 0.3);
  --glow-blue: 0 0 20px rgba(0, 153, 255, 0.3);
  
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --radius-2xl: 32px;
  
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 20px;
  --space-2xl: 24px;
  --space-3xl: 32px;
  --space-4xl: 48px;
  --space-5xl: 64px;
  
  --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

body {
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, system-ui, sans-serif;
  line-height: 1.6;
  overflow-x: hidden;
  min-height: 100vh;
}

/* =========================================================
   LAYOUT & CONTAINERS
   ========================================================= */
.app-container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--bg-glass);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border-soft);
  padding: var(--space-lg) var(--space-xl);
}

.header-content {
  max-width: 1400px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: var(--space-lg);
}

.logo {
  font-size: 24px;
  font-weight: 800;
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.ai-status {
  display: flex;
  align-items: center;
  gap: var(--space-sm);
  font-size: 14px;
  color: var(--text-secondary);
}

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--success);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(1.2); }
}

.ai-generate-btn {
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  color: var(--bg-primary);
  border: none;
  padding: var(--space-md) var(--space-xl);
  border-radius: var(--radius-lg);
  font-weight: 700;
  font-size: 14px;
  cursor: pointer;
  transition: all var(--transition-normal);
  box-shadow: var(--glow-green);
}

.ai-generate-btn:hover {
  transform: translateY(-2px);
  box-shadow: var(--glow-green), var(--neu-float);
}

.main-content {
  flex: 1;
  max-width: 1400px;
  margin: 0 auto;
  width: 100%;
  padding: var(--space-xl);
}

/* =========================================================
   NAVIGATION TABS
   ========================================================= */
.nav-tabs {
  display: flex;
  gap: var(--space-md);
  margin-bottom: var(--space-4xl);
  flex-wrap: wrap;
  justify-content: center;
}

.nav-tab {
  background: var(--bg-card);
  color: var(--text-secondary);
  border: 1px solid var(--border-soft);
  padding: var(--space-lg) var(--space-2xl);
  border-radius: var(--radius-xl);
  cursor: pointer;
  transition: all var(--transition-normal);
  backdrop-filter: blur(10px);
  font-weight: 600;
  font-size: 16px;
  position: relative;
  overflow: hidden;
}

.nav-tab::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
  opacity: 0;
  transition: opacity var(--transition-normal);
}

.nav-tab:hover,
.nav-tab.active {
  background: var(--bg-elevated);
  border-color: var(--accent-primary);
  color: var(--text-primary);
  transform: translateY(-2px);
  box-shadow: var(--neu-raise);
}

.nav-tab.active::before {
  opacity: 1;
}

/* =========================================================
   SECTION MANAGEMENT
   ========================================================= */
.section {
  display: none;
  animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.section.active {
  display: block;
}

@keyframes fadeInUp {
  from { 
    opacity: 0; 
    transform: translateY(30px); 
  }
  to { 
    opacity: 1; 
    transform: translateY(0); 
  }
}

/* =========================================================
   VISION SECTION
   ========================================================= */
.vision-container {
  background: var(--bg-card);
  border-radius: var(--radius-2xl);
  padding: var(--space-4xl);
  margin-bottom: var(--space-4xl);
  border: 1px solid var(--border-soft);
  box-shadow: var(--neu-raise);
  position: relative;
  overflow: hidden;
}

.vision-container::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
}

.vision-title {
  font-size: 32px;
  font-weight: 800;
  margin-bottom: var(--space-xl);
  text-align: center;
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.vision-input {
  width: 100%;
  background: var(--bg-elevated);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-lg);
  padding: var(--space-2xl);
  color: var(--text-primary);
  font-size: 18px;
  line-height: 1.8;
  min-height: 200px;
  resize: vertical;
  font-family: inherit;
  transition: all var(--transition-normal);
}

.vision-input:focus {
  outline: none;
  border-color: var(--accent-primary);
  box-shadow: 0 0 0 3px var(--accent-ghost), var(--glow-green);
}

.vision-actions {
  display: flex;
  gap: var(--space-lg);
  margin-top: var(--space-xl);
  justify-content: center;
  flex-wrap: wrap;
}

.btn {
  padding: var(--space-lg) var(--space-2xl);
  border-radius: var(--radius-lg);
  border: none;
  font-weight: 700;
  font-size: 16px;
  cursor: pointer;
  transition: all var(--transition-normal);
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.btn-primary {
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  color: var(--bg-primary);
  box-shadow: var(--glow-green);
}

.btn-secondary {
  background: var(--bg-elevated);
  color: var(--text-primary);
  border: 1px solid var(--border-medium);
}

.btn:hover {
  transform: translateY(-2px);
  box-shadow: var(--neu-float);
}

/* =========================================================
   AI GENERATED PHOTOS GRID
   ========================================================= */
.vision-photos {
  margin-top: var(--space-4xl);
  display: none;
}

.vision-photos.active {
  display: block;
  animation: fadeInUp 0.8s ease;
}

.photos-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: var(--space-xl);
  margin-top: var(--space-xl);
}

.photo-card {
  background: var(--bg-elevated);
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--neu-raise);
  border: 1px solid var(--border-soft);
  transition: all var(--transition-normal);
  cursor: pointer;
  position: relative;
}

.photo-card:hover {
  transform: translateY(-8px);
  box-shadow: var(--neu-float);
  border-color: var(--accent-primary);
}

.photo-placeholder {
  aspect-ratio: 16/9;
  background: linear-gradient(135deg, var(--bg-overlay), var(--bg-card));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 48px;
  position: relative;
  overflow: hidden;
  background-size: cover;
  background-position: center;
}

.photo-placeholder::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(0,255,136,0.1), transparent);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { left: -100%; }
  100% { left: 100%; }
}

.photo-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(transparent, rgba(0,0,0,0.8));
  padding: var(--space-xl);
  color: white;
}

.photo-title {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: var(--space-sm);
}

.photo-desc {
  font-size: 14px;
  opacity: 0.9;
}

/* =========================================================
   HIERARCHY FLOW
   ========================================================= */
.hierarchy-flow {
  margin: var(--space-5xl) 0;
}

.flow-level {
  margin-bottom: var(--space-4xl);
}

.level-header {
  text-align: center;
  margin-bottom: var(--space-2xl);
}

.level-title {
  font-size: 28px;
  font-weight: 800;
  margin-bottom: var(--space-sm);
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
}

.level-subtitle {
  color: var(--text-secondary);
  font-size: 16px;
}

/* =========================================================
   GOAL CARDS
   ========================================================= */
.goals-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  gap: var(--space-xl);
}

.goal-card {
  background: var(--bg-card);
  border-radius: var(--radius-xl);
  padding: var(--space-2xl);
  border: 1px solid var(--border-soft);
  box-shadow: var(--neu-raise);
  transition: all var(--transition-normal);
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.goal-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
  transform: scaleX(0);
  transition: transform var(--transition-normal);
}

.goal-card:hover::before {
  transform: scaleX(1);
}

.goal-card:hover {
  transform: translateY(-4px);
  box-shadow: var(--neu-float);
  border-color: var(--accent-primary);
}

.goal-card.mega {
  border-left: 4px solid var(--accent-primary);
  background: linear-gradient(135deg, var(--bg-card), var(--bg-elevated));
}

.goal-header {
  display: flex;
  align-items: flex-start;
  gap: var(--space-lg);
  margin-bottom: var(--space-lg);
}

.goal-icon {
  width: 50px;
  height: 50px;
  border-radius: var(--radius-md);
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  color: var(--bg-primary);
  flex-shrink: 0;
}

.goal-content {
  flex: 1;
}

.goal-title {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: var(--space-sm);
  color: var(--text-primary);
}

.goal-desc {
  color: var(--text-secondary);
  font-size: 14px;
  line-height: 1.6;
}

.goal-meta {
  display: flex;
  align-items: center;
  gap: var(--space-lg);
  margin-top: var(--space-lg);
  flex-wrap: wrap;
}

.goal-progress {
  flex: 1;
  min-width: 150px;
}

.progress-label {
  display: flex;
  justify-content: space-between;
  margin-bottom: var(--space-sm);
  font-size: 12px;
  color: var(--text-muted);
}

.progress-bar {
  height: 6px;
  background: var(--bg-overlay);
  border-radius: 3px;
  overflow: hidden;
  position: relative;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
  border-radius: 3px;
  transition: width var(--transition-slow);
  position: relative;
}

.progress-fill::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: progressShine 2s infinite;
}

@keyframes progressShine {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.goal-priority {
  padding: var(--space-xs) var(--space-md);
  border-radius: var(--radius-sm);
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.priority-high {
  background: rgba(255, 71, 87, 0.2);
  color: var(--error);
  border: 1px solid var(--error);
}

.priority-medium {
  background: rgba(255, 165, 2, 0.2);
  color: var(--warning);
  border: 1px solid var(--warning);
}

.priority-low {
  background: rgba(0, 255, 136, 0.2);
  color: var(--success);
  border: 1px solid var(--success);
}

/* =========================================================
   TODAY'S FOCUS BANNER
   ========================================================= */
.today-focus {
  background: linear-gradient(135deg, var(--bg-elevated), var(--bg-card));
  border-radius: var(--radius-2xl);
  padding: var(--space-4xl);
  margin-bottom: var(--space-4xl);
  border: 1px solid var(--border-soft);
  box-shadow: var(--neu-raise);
  text-align: center;
  position: relative;
  overflow: hidden;
}

.today-focus::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 3px;
  background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
}

.focus-date {
  font-size: 18px;
  color: var(--text-secondary);
  margin-bottom: var(--space-lg);
}

.focus-goal {
  font-size: 36px;
  font-weight: 800;
  margin-bottom: var(--space-lg);
  background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  line-height: 1.2;
}

.focus-tasks {
  font-size: 16px;
  color: var(--text-secondary);
}

/* =========================================================
   ENHANCED TASK SYSTEM
   ========================================================= */
.tasks-container {
  background: var(--bg-card);
  border-radius: var(--radius-xl);
  padding: var(--space-2xl);
  border: 1px solid var(--border-soft);
  box-shadow: var(--neu-raise);
}

.tasks-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-xl);
  flex-wrap: wrap;
  gap: var(--space-lg);
}

.task-filters {
  display: flex;
  gap: var(--space-md);
  flex-wrap: wrap;
}

.filter-btn {
  padding: var(--space-sm) var(--space-lg);
  border-radius: var(--radius-md);
  border: 1px solid var(--border-soft);
  background: var(--bg-elevated);
  color: var(--text-secondary);
  font-size: 14px;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.filter-btn.active,
.filter-btn:hover {
  background: var(--accent-primary);
  color: var(--bg-primary);
  border-color: var(--accent-primary);
}

.tasks-timeline {
  margin-bottom: var(--space-xl);
}

.timeline-header {
  font-size: 20px;
  font-weight: 700;
  margin-bottom: var(--space-lg);
  color: var(--text-primary);
  text-align: center;
}

.period-section {
  background: var(--bg-elevated);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  border: 1px solid var(--border-soft);
  margin-bottom: var(--space-lg);
}

.period-title {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: var(--space-md);
  color: var(--accent-primary);
  display: flex;
  align-items: center;
  gap: var(--space-sm);
}

.task-item {
  display: flex;
  align-items: center;
  gap: var(--space-lg);
  padding: var(--space-lg);
  background: var(--bg-elevated);
  border-radius: var(--radius-md);
  margin-bottom: var(--space-md);
  border: 1px solid var(--border-soft);
  transition: all var(--transition-normal);
  cursor: pointer;
}

.task-item:hover {
  background: var(--bg-overlay);
  border-color: var(--accent-primary);
  transform: translateX(4px);
}

.task-checkbox {
  width: 24px;
  height: 24px;
  border: 2px solid var(--border-medium);
  border-radius: var(--radius-sm);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all var(--transition-fast);
}

.task-checkbox.completed {
  background: var(--accent-primary);
  border-color: var(--accent-primary);
  color: var(--bg-primary);
}

.task-checkbox:hover {
  border-color: var(--accent-primary);
  box-shadow: var(--glow-green);
}

.task-content {
  flex: 1;
}

.task-title {
  font-weight: 600;
  margin-bottom: var(--space-xs);
  font-size: 16px;
}

.task-title.completed {
  text-decoration: line-through;
  opacity: 0.6;
}

.task-meta {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  font-size: 12px;
  color: var(--text-muted);
}

/* =========================================================
   DRAGGABLE IDEAS
   ========================================================= */
.ideas-board {
  background: var(--bg-secondary);
  border-radius: var(--radius-2xl);
  padding: var(--space-4xl);
  margin: var(--space-4xl) 0;
  min-height: 400px;
  border: 2px dashed var(--border-medium);
  position: relative;
  overflow: hidden;
}

.ideas-board.active {
  border-color: var(--accent-primary);
  box-shadow: var(--glow-green);
}

.idea-item {
  position: absolute;
  background: var(--bg-card);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  border: 1px solid var(--border-soft);
  box-shadow: var(--neu-raise);
  cursor: move;
  transition: all var(--transition-fast);
  min-width: 200px;
  max-width: 250px;
}

.idea-item:hover {
  transform: scale(1.05);
  box-shadow: var(--neu-float);
  border-color: var(--accent-primary);
}

.idea-item.dragging {
  transform: rotate(5deg);
  z-index: 1000;
  box-shadow: var(--neu-float);
}

/* =========================================================
   AI INTEGRATION MODAL
   ========================================================= */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(20px);
  z-index: 10000;
  display: none;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity var(--transition-normal);
}

.modal-overlay.active {
  display: flex;
  opacity: 1;
}

.modal {
  background: var(--bg-primary);
  border-radius: var(--radius-2xl);
  box-shadow: var(--neu-float);
  border: 1px solid var(--border-soft);
  width: 95%;
  max-width: 800px;
  max-height: 90vh;
  overflow: hidden;
  animation: modalSlideUp 0.4s ease;
}

@keyframes modalSlideUp {
  from { 
    transform: translateY(50px) scale(0.95); 
    opacity: 0; 
  }
  to { 
    transform: translateY(0) scale(1); 
    opacity: 1; 
  }
}

.modal-header {
  background: var(--bg-elevated);
  padding: var(--space-xl);
  border-bottom: 1px solid var(--border-soft);
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.modal-title {
  font-size: 24px;
  font-weight: 800;
  display: flex;
  align-items: center;
  gap: var(--space-md);
}

.modal-close {
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  color: var(--text-muted);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all var(--transition-fast);
  font-size: 18px;
}

.modal-close:hover {
  background: var(--error);
  color: white;
  transform: scale(1.1);
}

.modal-body {
  padding: var(--space-xl);
  max-height: 60vh;
  overflow-y: auto;
}

/* =========================================================
   LOADING & ANIMATIONS
   ========================================================= */
.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 2px solid var(--border-soft);
  border-radius: 50%;
  border-top-color: var(--accent-primary);
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.ai-thinking {
  display: flex;
  align-items: center;
  gap: var(--space-md);
  color: var(--text-secondary);
  font-style: italic;
}

.thinking-dots {
  display: flex;
  gap: 4px;
}

.thinking-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--accent-primary);
  animation: thinking 1.4s infinite ease-in-out;
}

.thinking-dot:nth-child(1) { animation-delay: -0.32s; }
.thinking-dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes thinking {
  0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
  40% { transform: scale(1); opacity: 1; }
}

/* =========================================================
   NOTIFICATIONS
   ========================================================= */
.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--bg-card);
  border: 1px solid var(--border-soft);
  border-radius: var(--radius-lg);
  padding: var(--space-lg);
  box-shadow: var(--neu-float);
  z-index: 10001;
  transform: translateX(100%);
  transition: transform var(--transition-normal);
  min-width: 300px;
}

.notification.show {
  transform: translateX(0);
}

.notification.success {
  border-left: 4px solid var(--success);
}

.notification.error {
  border-left: 4px solid var(--error);
}

.notification.warning {
  border-left: 4px solid var(--warning);
}

/* =========================================================
   RESPONSIVE DESIGN
   ========================================================= */
@media (max-width: 1024px) {
  .goals-grid {
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  }
  
  .photos-grid {
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }
  
  .focus-goal {
    font-size: 28px;
  }
}

@media (max-width: 768px) {
  .main-content {
    padding: var(--space-lg);
  }
  
  .header-content {
    flex-direction: column;
    text-align: center;
  }
  
  .nav-tabs {
    flex-direction: column;
    align-items: center;
  }
  
  .vision-container {
    padding: var(--space-2xl);
  }
  
  .vision-title {
    font-size: 24px;
  }
  
  .focus-goal {
    font-size: 24px;
  }
  
  .goals-grid {
    grid-template-columns: 1fr;
  }
  
  .photos-grid {
    grid-template-columns: 1fr;
  }
  
  .tasks-header {
    flex-direction: column;
    align-items: stretch;
  }
  
  .modal {
    width: 98%;
    margin: var(--space-sm);
  }
}

/* =========================================================
   UTILITY CLASSES
   ========================================================= */
.hidden {
  display: none !important;
}

.fade-in {
  animation: fadeIn 0.6s ease;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.scale-in {
  animation: scaleIn 0.4s ease;
}

@keyframes scaleIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* =========================================================
   DARK THEME ENHANCEMENTS
   ========================================================= */
::selection {
  background: rgba(0, 255, 136, 0.3);
}

::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
  background: var(--border-medium);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--accent-primary);
}

button:focus,
input:focus,
textarea:focus {
  outline: 2px solid var(--accent-primary);
  outline-offset: 2px;
}

@media (prefers-contrast: high) {
  :root {
    --border-soft: #555;
    --border-medium: #777;
  }
}

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <header class="header">
      <div class="header-content">
        <div class="logo">
          🎯 Ultimate Tikslų Sistema
        </div>
        <div class="ai-status">
          <span class="status-dot"></span>
          AI Generavimo Variklis Aktyvus
        </div>
        <button class="ai-generate-btn" id="aiGenerateBtn">
          ✨ AI Generuoti Nuotraukas
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Navigation -->
      <div class="nav-tabs">
        <button class="nav-tab active" data-section="vision">⭐ Vizija</button>
        <button class="nav-tab" data-section="mega-goals">🚀 Mega Tikslai</button>
        <button class="nav-tab" data-section="goals">🎯 Tikslai</button>
        <button class="nav-tab" data-section="daily">📅 Šiandien</button>
        <button class="nav-tab" data-section="ideas">💡 Idėjų Lenta</button>
      </div>

      <!-- Today's Focus Banner -->
      <div class="today-focus">
        <div class="focus-date" id="todayDate">Šiandien • 2025-01-01</div>
        <div class="focus-goal" id="todayGoal">Sukurkite savo ateities viziją</div>
        <div class="focus-tasks" id="todayTasks">Pradėkite nuo vizijos aprašymo</div>
      </div>

      <!-- Vision Section -->
      <section class="section active" id="vision">
        <div class="vision-container">
          <h2 class="vision-title">⭐ Mano Ateities Vizija</h2>
          <textarea 
            class="vision-input" 
            id="visionInput" 
            placeholder="Aprašykite savo viziją... Kur norite būti po 5-10 metų? Kokie tikslai jums svarbiausi? Apie ką svajojate?"
          >Noriu sukurti finansiškai nepriklausomą gyvenimą per savo technologijų verslą. Svajoju turėti laimingą šeimą su 2-3 vaikais, gyventi moderniame ekologiškame name, išlaikyti puikią fizinę sveikatą. Noriu keliauti po pasaulį su šeima, daryti pozityvų poveikį per inovacijas ir padėti kitiems pasiekti savo tikslus technologijų pagalba.</textarea>
          
          <div class="vision-actions">
            <button class="btn btn-primary" id="generatePhotosBtn">
              ✨ Generuoti Svajonių Nuotraukas
            </button>
            <button class="btn btn-secondary" id="extractGoalsBtn">
              🎯 Išskirti Tikslus iš Vizijos
            </button>
          </div>

          <!-- AI Generated Photos -->
          <div class="vision-photos" id="visionPhotos">
            <h3 style="text-align: center; margin-bottom: 24px; color: var(--text-secondary);">AI Sugeneruotos Vizijos Nuotraukos</h3>
            <div class="photos-grid" id="photosGrid">
              <!-- Photos will be generated here -->
            </div>
          </div>
        </div>
      </section>

      <!-- Mega Goals Section -->
      <section class="section" id="mega-goals">
        <div class="hierarchy-flow">
          <div class="flow-level">
            <div class="level-header">
              <h2 class="level-title">🚀 Mega Tikslai (5+ metų)</h2>
              <p class="level-subtitle">Didžiausi gyvenimo tikslai, kurie formuoja jūsų ateitį</p>
            </div>
            
            <div class="goals-grid" id="megaGoalsGrid">
              <!-- Mega goals will be populated here -->
            </div>
          </div>
        </div>
      </section>

      <!-- Goals Section -->
      <section class="section" id="goals">
        <div class="hierarchy-flow">
          <div class="flow-level">
            <div class="level-header">
              <h2 class="level-title">🎯 Tikslai (1-2 metai)</h2>
              <p class="level-subtitle">Konkretūs žingsniai link mega tikslų</p>
            </div>
            
            <div class="goals-grid" id="goalsGrid">
              <!-- Goals will be populated here -->
            </div>
          </div>
        </div>
      </section>

      <!-- Daily Tasks Section -->
      <section class="section" id="daily">
        <div class="tasks-container">
          <div class="tasks-header">
            <h2 class="level-title" id="tasksTitle">📅 Šiandienos užduotys</h2>
            <div class="task-filters">
              <button class="filter-btn active" data-filter="today">Šiandien</button>
              <button class="filter-btn" data-filter="week">Savaitė</button>
              <button class="filter-btn" data-filter="month">Mėnuo</button>
              <button class="filter-btn" data-filter="year">Metai</button>
            </div>
          </div>
          
          <div class="tasks-timeline" id="tasksTimeline" style="display: none;">
            <!-- Dynamic timeline will be rendered here -->
          </div>
          
          <div id="tasksContainer">
            <!-- Tasks will be populated here -->
          </div>
        </div>
      </section>

      <!-- Ideas Board Section -->
      <section class="section" id="ideas">
        <div class="level-header">
          <h2 class="level-title">💡 Idėjų Lenta</h2>
          <p class="level-subtitle">Tempkite idėjas, organizuokite mintis, kurkite ryšius</p>
        </div>
        
        <div class="ideas-board" id="ideasBoard">
          <!-- Draggable ideas will be here -->
        </div>
        
        <div style="text-align: center; margin-top: 24px;">
          <button class="btn btn-primary" id="addIdeaBtn">
            ➕ Pridėti Naują Idėją
          </button>
        </div>
      </section>
    </main>
  </div>

  <!-- AI Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">AI Apdorojimas</h2>
        <button class="modal-close" id="modalClose">×</button>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- Modal content -->
      </div>
    </div>
  </div>

  <!-- Notification -->
  <div class="notification" id="notification">
    <!-- Notifications will appear here -->
  </div>

  <script>
    // =========================================================
    // GLOBAL STATE - SIMPLE AND CLEAN
    // =========================================================
    let currentSection = 'vision';
    let currentTimeFilter = 'today';
    let isAIProcessing = false;
    let hasGeneratedContent = false;

    // Sample data with 6 goal cards
    const megaGoals = [
      {
        id: 'mg1',
        title: 'Finansinė laisvė - 1M€',
        description: 'Sukurti technologijų verslą ir investicijų portfelį ilgalaikiam saugumui',
        icon: '💰',
        progress: 35,
        priority: 'high',
        timeframe: '5 metai'
      },
      {
        id: 'mg2', 
        title: 'Šeimos svajonių namas',
        description: 'Modernus ekologiškas namas su šeimos zona ir technologijomis',
        icon: '🏡',
        progress: 20,
        priority: 'medium',
        timeframe: '3 metai'
      },
      {
        id: 'mg3',
        title: 'Laiminga šeima',
        description: 'Stiprūs santykiai, 2-3 vaikai, bendri išgyvenimai ir prisiminimai',
        icon: '👨‍👩‍👧‍👦',
        progress: 70,
        priority: 'high',
        timeframe: 'Visas gyvenimas'
      }
    ];

    const goals = [
      {
        id: 'g1',
        title: 'SaaS produkto kūrimas',
        description: 'Sukurti AI-powered tikslų valdymo platformą verslo klientams',
        icon: '💻',
        progress: 65,
        priority: 'high',
        deadline: '2025-06-30'
      },
      {
        id: 'g2',
        title: 'Investicijų portfelis',
        description: 'Diversifikuotas portfelis: akcijos, NT, crypto, obligacijos',
        icon: '📈',
        progress: 45,
        priority: 'medium',
        deadline: '2025-12-31'
      },
      {
        id: 'g3',
        title: 'Namo taupymas',
        description: 'Sukaupta 150k€ įnašui ir statybų finansavimui',
        icon: '💎',
        progress: 30,
        priority: 'high',
        deadline: '2026-01-01'
      },
      {
        id: 'g4',
        title: 'Santykių stiprinimas',
        description: 'Savaitės date nights, bendri projektai, komunikacijos gerinimas',
        icon: '💕',
        progress: 80,
        priority: 'high',
        deadline: '2025-12-31'
      },
      {
        id: 'g5',
        title: 'Fizinės formos gerinimas',
        description: 'Reguliarus sportas 4x/savaitę, sveika mityba, 10kg numesti',
        icon: '💪',
        progress: 55,
        priority: 'medium',
        deadline: '2025-08-31'
      },
      {
        id: 'g6',
        title: 'Technologijų mokymasis',
        description: 'AI/ML specializacija, nauji programavimo įrankiai, sertifikatai',
        icon: '🤖',
        progress: 40,
        priority: 'medium',
        deadline: '2025-09-30'
      }
    ];

    let dailyTasks = [];
    let ideas = [
      { id: 'i1', text: 'AI coaching platforma', x: 20, y: 20 },
      { id: 'i2', text: 'Tvaraus gyvenimo blogai', x: 250, y: 80 },
      { id: 'i3', text: 'Šeimos kelionių vlogai', x: 100, y: 150 },
      { id: 'i4', text: 'Investicijų naujienlaiškis', x: 300, y: 200 }
    ];

    // =========================================================
    // INITIALIZATION
    // =========================================================
    document.addEventListener('DOMContentLoaded', function() {
      console.log('🎯 Sistema kraunasi...');
      
      try {
        initializeApp();
        bindEvents();
        renderAll();
        
        console.log('✅ Sistema sėkmingai paleista!');
        showNotification('🚀 Ultimate Tikslų Sistema pasiruošusi darbui!', 'success');
      } catch (error) {
        console.error('❌ Klaida paleidžiant sistemą:', error);
        showNotification('Klaida paleidžiant sistemą. Perkraukite puslapį.', 'error');
      }
    });

    function initializeApp() {
      const today = new Date();
      const options = { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      };
      document.getElementById('todayDate').textContent = 
        `Šiandien • ${today.toLocaleDateString('lt-LT', options)}`;
      
      generateTimeBasedTasks();
      updateTodayBanner();
    }

    function bindEvents() {
      // Navigation tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.addEventListener('click', function() {
          switchSection(this.dataset.section);
        });
      });

      // AI buttons
      document.getElementById('generatePhotosBtn').addEventListener('click', generateVisionPhotos);
      document.getElementById('aiGenerateBtn').addEventListener('click', generateVisionPhotos);
      document.getElementById('extractGoalsBtn').addEventListener('click', extractGoalsFromVision);

      // Modal
      document.getElementById('modalClose').addEventListener('click', closeModal);
      document.getElementById('modalOverlay').addEventListener('click', function(e) {
        if (e.target === this) closeModal();
      });

      // Ideas
      document.getElementById('addIdeaBtn').addEventListener('click', addNewIdea);

      // Task filters
      document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          currentTimeFilter = this.dataset.filter;
          updateTasksTitle();
          generateTimeBasedTasks();
          renderTasks();
        });
      });

      // Keyboard shortcuts
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') closeModal();
        
        if (e.key >= '1' && e.key <= '5') {
          const sections = ['vision', 'mega-goals', 'goals', 'daily', 'ideas'];
          const sectionIndex = parseInt(e.key) - 1;
          if (sections[sectionIndex]) {
            switchSection(sections[sectionIndex]);
          }
        }
      });
    }

    function renderAll() {
      renderMegaGoals();
      renderGoals();
      renderTasks();
      renderIdeas();
    }

    // =========================================================
    // SECTION MANAGEMENT
    // =========================================================
    function switchSection(sectionId) {
      // Update active tab
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');

      // Update active section
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(sectionId).classList.add('active');

      currentSection = sectionId;
      updateTodayBanner();
    }

    function updateTodayBanner() {
      const goalTexts = {
        vision: 'Sukurkite savo ateities viziją',
        'mega-goals': 'Planuokite mega tikslus',
        goals: 'Suskaidykite tikslus į žingsnius',
        daily: 'Įvykdykite šiandienos užduotis',
        ideas: 'Organizuokite idėjas'
      };

      const taskCounts = {
        vision: 'Pradėkite nuo vizijos aprašymo',
        'mega-goals': `${megaGoals.length} mega tikslai aktyvūs`,
        goals: `${goals.length} tikslai progrese`,
        daily: `${dailyTasks.filter(t => !t.completed).length} užduotys laukia sprendimo`,
        ideas: 'Kurkite ir organizuokite idėjas'
      };

      document.getElementById('todayGoal').textContent = goalTexts[currentSection];
      document.getElementById('todayTasks').textContent = taskCounts[currentSection];
    }

    function updateTasksTitle() {
      const titles = {
        today: '📅 Šiandienos užduotys',
        week: '📅 Užduotys šią savaitę',
        month: '📅 Užduotys šį mėnesį',
        year: '📅 Užduotys šiems metams'
      };
      
      document.getElementById('tasksTitle').textContent = titles[currentTimeFilter];
    }

    // =========================================================
    // AI PHOTO GENERATION - SIMPLIFIED
    // =========================================================
    async function generateVisionPhotos() {
      if (isAIProcessing) return;
      
      const visionText = document.getElementById('visionInput').value.trim();
      if (!visionText) {
        showNotification('Pirmiausia aprašykite savo viziją!', 'warning');
        return;
      }

      isAIProcessing = true;
      
      showModal('✨ AI Nuotraukų Generavimas', `
        <div class="ai-thinking">
          <div class="loading"></div>
          Analizuoju jūsų viziją ir generuoju nuotraukas...
          <div class="thinking-dots">
            <div class="thinking-dot"></div>
            <div class="thinking-dot"></div>
            <div class="thinking-dot"></div>
          </div>
        </div>
        <div style="margin-top: 24px; padding: 20px; background: var(--bg-elevated); border-radius: 16px;">
          <h4>Analizuojama vizija:</h4>
          <p style="color: var(--text-secondary); margin-top: 8px; font-style: italic;">"${visionText.substring(0, 200)}..."</p>
        </div>
      `);

      // Simulate AI processing
      await new Promise(resolve => setTimeout(resolve, 3000));

      // Generate photos
      const photos = [
        {
          id: 'p1',
          url: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=600&h=400&fit=crop',
          title: 'Svajonių namas',
          description: 'Modernus ekologiškas namas'
        },
        {
          id: 'p2',
          url: 'https://images.unsplash.com/photo-1609220136736-443140cffec6?w=600&h=400&fit=crop',
          title: 'Laiminga šeima',
          description: 'Šeimos laimė ir meilė'
        },
        {
          id: 'p3',
          url: 'https://images.unsplash.com/photo-1560472354-b33ff0c44a43?w=600&h=400&fit=crop',
          title: 'Technologijų verslas',
          description: 'Sėkmingas tech verslas'
        },
        {
          id: 'p4',
          url: 'https://images.unsplash.com/photo-1488646953014-85cb44e25828?w=600&h=400&fit=crop',
          title: 'Kelionės su šeima',
          description: 'Išvykos po pasaulį'
        }
      ];
      
      displayGeneratedPhotos(photos);
      closeModal();
      
      hasGeneratedContent = true;
      showNotification('AI sėkmingai sugeneravo jūsų vizijos nuotraukas! ✨', 'success');
      
      isAIProcessing = false;
    }

    function displayGeneratedPhotos(photos) {
      const photosContainer = document.getElementById('visionPhotos');
      const photosGrid = document.getElementById('photosGrid');
      
      photosGrid.innerHTML = '';
      
      photos.forEach(photo => {
        const photoCard = document.createElement('div');
        photoCard.className = 'photo-card scale-in';
        photoCard.innerHTML = `
          <div class="photo-placeholder" style="background-image: url('${photo.url}');">
            <div class="photo-overlay">
              <div class="photo-title">${photo.title}</div>
              <div class="photo-desc">${photo.description}</div>
              <div style="font-size: 10px; opacity: 0.7; margin-top: 4px;">✨ AI Sugeneruota</div>
            </div>
          </div>
        `;
        
        photoCard.addEventListener('click', () => {
          showModal(`📸 ${photo.title}`, `
            <div style="text-align: center;">
              <img src="${photo.url}" alt="${photo.title}" style="width: 100%; max-width: 500px; border-radius: 16px; margin-bottom: 20px;">
              <h3>${photo.title}</h3>
              <p style="color: var(--text-secondary); margin: 16px 0;">${photo.description}</p>
              <div style="margin-top: 24px;">
                <button class="btn btn-primary" onclick="closeModal(); showNotification('Nuotrauka konvertuota į tikslą! 🎯', 'success');">
                  🎯 Konvertuoti į tikslą
                </button>
              </div>
            </div>
          `);
        });
        
        photosGrid.appendChild(photoCard);
      });
      
      photosContainer.classList.add('active');
    }

    async function extractGoalsFromVision() {
      if (isAIProcessing) return;
      
      const visionText = document.getElementById('visionInput').value.trim();
      if (!visionText) {
        showNotification('Pirmiausia aprašykite savo viziją!', 'warning');
        return;
      }

      isAIProcessing = true;
      
      showModal('🎯 AI Tikslų Išskyrimas', `
        <div class="ai-thinking">
          <div class="loading"></div>
          Analizuoju viziją ir išskiri tikslus...
          <div class="thinking-dots">
            <div class="thinking-dot"></div>
            <div class="thinking-dot"></div>
            <div class="thinking-dot"></div>
          </div>
        </div>
      `);

      await new Promise(resolve => setTimeout(resolve, 2000));
      
      closeModal();
      showNotification('Tikslai sėkmingai išskirti iš jūsų vizijos! 🎯', 'success');
      
      setTimeout(() => {
        switchSection('mega-goals');
      }, 1000);
      
      isAIProcessing = false;
    }

    // =========================================================
    // GOAL RENDERING
    // =========================================================
    function renderMegaGoals() {
      const container = document.getElementById('megaGoalsGrid');
      container.innerHTML = '';
      
      megaGoals.forEach(goal => {
        const goalCard = createGoalCard(goal, true);
        container.appendChild(goalCard);
      });
    }

    function renderGoals() {
      const container = document.getElementById('goalsGrid');
      container.innerHTML = '';
      
      goals.forEach(goal => {
        const goalCard = createGoalCard(goal, false);
        container.appendChild(goalCard);
      });
    }

    function createGoalCard(goal, isMega = false) {
      const card = document.createElement('div');
      card.className = `goal-card ${isMega ? 'mega' : ''} fade-in`;
      
      card.innerHTML = `
        <div class="goal-header">
          <div class="goal-icon">${goal.icon}</div>
          <div class="goal-content">
            <h3 class="goal-title">${goal.title}</h3>
            <p class="goal-desc">${goal.description}</p>
          </div>
        </div>
        <div class="goal-meta">
          <div class="goal-progress">
            <div class="progress-label">
              <span>Progresas</span>
              <span>${goal.progress}%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${goal.progress}%"></div>
            </div>
          </div>
          <div class="goal-priority priority-${goal.priority}">
            ${goal.priority === 'high' ? 'Aukštas' : goal.priority === 'medium' ? 'Vidutinis' : 'Žemas'}
          </div>
        </div>
      `;
      
      card.addEventListener('click', () => {
        showModal(`${isMega ? '🚀' : '🎯'} ${goal.title}`, `
          <div style="text-align: center;">
            <div style="font-size: 48px; margin-bottom: 16px;">${goal.icon}</div>
            <h3>${goal.title}</h3>
            <p style="color: var(--text-secondary); margin: 16px 0;">${goal.description}</p>
            <div style="background: var(--bg-elevated); padding: 16px; border-radius: 12px; margin: 20px 0;">
              <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                <span>Progresas</span>
                <span>${goal.progress}%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" style="width: ${goal.progress}%"></div>
              </div>
            </div>
            <button class="btn btn-primary" onclick="closeModal(); switchSection('daily'); showNotification('Rodomos ${goal.title} užduotys 🎯', 'info');">
              📅 Rodyti užduotis
            </button>
          </div>
        `);
      });
      
      return card;
    }

    // =========================================================
    // TASK SYSTEM - SIMPLIFIED
    // =========================================================
    function generateTimeBasedTasks() {
      if (currentTimeFilter === 'today') {
        dailyTasks = [
          {
            id: 't1',
            title: 'Parašyti verslo plano skyrių',
            description: 'Finansinių projekcijų dalis',
            completed: false,
            priority: 'high'
          },
          {
            id: 't2',
            title: 'Investicijų rinkos tyrimai',
            description: 'S&P 500 analizė',
            completed: true,
            priority: 'medium'
          },
          {
            id: 't3',
            title: 'Šeimos laikas - vakarienė',
            description: 'Bendras laikas su šeima',
            completed: false,
            priority: 'high'
          }
        ];
      } else if (currentTimeFilter === 'week') {
        dailyTasks = [
          { id: 'tw1', title: 'Pirmadienis: Produkto vystymas', description: 'AI platformos kūrimas', completed: false, priority: 'high', day: 'Pirmadienis' },
          { id: 'tw2', title: 'Antradienis: Investicijų stebėjimas', description: 'Portfelio analizė', completed: false, priority: 'medium', day: 'Antradienis' },
          { id: 'tw3', title: 'Trečiadienis: Šeimos veiklos', description: 'Bendras laikas', completed: true, priority: 'high', day: 'Trečiadienis' },
          { id: 'tw4', title: 'Ketvirtadienis: Sporto treniruotė', description: 'Fiziniai pratimai', completed: false, priority: 'medium', day: 'Ketvirtadienis' },
          { id: 'tw5', title: 'Penktadienis: Projektų baigimas', description: 'Savaitės tikslų finalizavimas', completed: false, priority: 'high', day: 'Penktadienis' },
          { id: 'tw6', title: 'Šeštadienis: Poilsis ir hobiai', description: 'Laisvalaikio veiklos', completed: false, priority: 'low', day: 'Šeštadienis' },
          { id: 'tw7', title: 'Sekmadienis: Savaitės planavimas', description: 'Kitos savaitės strategija', completed: false, priority: 'medium', day: 'Sekmadienis' }
        ];
      } else if (currentTimeFilter === 'month') {
        dailyTasks = [
          { id: 'tm1', title: '1 savaitė: SaaS MVP kūrimas', description: 'Pagrindinės funkcijos', completed: false, priority: 'high', week: '1 savaitė' },
          { id: 'tm2', title: '2 savaitė: Investicijų diversifikavimas', description: 'Naujų galimybių paieška', completed: false, priority: 'medium', week: '2 savaitė' },
          { id: 'tm3', title: '3 savaitė: Šeimos projektai', description: 'Bendri hobiai', completed: false, priority: 'high', week: '3 savaitė' },
          { id: 'tm4', title: '4 savaitė: Sveikatingumo rutina', description: 'Mėnesio sporto planas', completed: false, priority: 'medium', week: '4 savaitė' }
        ];
      } else if (currentTimeFilter === 'year') {
        const months = ['Sausis', 'Vasaris', 'Kovas', 'Balandis', 'Gegužė', 'Birželis', 'Liepa', 'Rugpjūtis', 'Rugsėjis', 'Spalis', 'Lapkritis', 'Gruodis'];
        dailyTasks = months.map((month, index) => ({
          id: `ty${index}`,
          title: `${month}: Verslo plėtra`,
          description: 'Mėnesio produkto vystymo tikslai',
          completed: index < new Date().getMonth() ? Math.random() > 0.3 : false,
          priority: 'high',
          month: month
        }));
      }
    }

    function renderTasks() {
      const container = document.getElementById('tasksContainer');
      const timeline = document.getElementById('tasksTimeline');
      
      container.innerHTML = '';
      timeline.innerHTML = '';
      timeline.style.display = 'none';
      
      if (currentTimeFilter === 'today') {
        dailyTasks.forEach(task => {
          const taskItem = createTaskElement(task);
          container.appendChild(taskItem);
        });
      } else {
        timeline.style.display = 'block';
        
        if (currentTimeFilter === 'week') {
          const days = ['Pirmadienis', 'Antradienis', 'Trečiadienis', 'Ketvirtadienis', 'Penktadienis', 'Šeštadienis', 'Sekmadienis'];
          days.forEach(day => {
            const dayTasks = dailyTasks.filter(task => task.day === day);
            if (dayTasks.length > 0) {
              renderPeriodSection(timeline, day, dayTasks);
            }
          });
        } else if (currentTimeFilter === 'month') {
          const weeks = ['1 savaitė', '2 savaitė', '3 savaitė', '4 savaitė'];
          weeks.forEach(week => {
            const weekTasks = dailyTasks.filter(task => task.week === week);
            if (weekTasks.length > 0) {
              renderPeriodSection(timeline, week, weekTasks);
            }
          });
        } else if (currentTimeFilter === 'year') {
          const months = ['Sausis', 'Vasaris', 'Kovas', 'Balandis', 'Gegužė', 'Birželis', 'Liepa', 'Rugpjūtis', 'Rugsėjis', 'Spalis', 'Lapkritis', 'Gruodis'];
          months.forEach(month => {
            const monthTasks = dailyTasks.filter(task => task.month === month);
            if (monthTasks.length > 0) {
              renderPeriodSection(timeline, month, monthTasks);
            }
          });
        }
      }
    }

    function renderPeriodSection(container, periodName, tasks) {
      const section = document.createElement('div');
      section.className = 'period-section';
      section.innerHTML = `
        <div class="period-title">📅 ${periodName}</div>
        ${tasks.map(task => `
          <div class="task-item" onclick="toggleTask('${task.id}')">
            <div class="task-checkbox ${task.completed ? 'completed' : ''}">
              ${task.completed ? '✓' : ''}
            </div>
            <div class="task-content">
              <div class="task-title ${task.completed ? 'completed' : ''}">${task.title}</div>
              <div class="task-meta">
                <span>${task.description}</span>
                <span class="goal-priority priority-${task.priority}">
                  ${task.priority === 'high' ? 'Aukštas' : task.priority === 'medium' ? 'Vidutinis' : 'Žemas'}
                </span>
              </div>
            </div>
          </div>
        `).join('')}
      `;
      container.appendChild(section);
    }

    function createTaskElement(task) {
      const taskItem = document.createElement('div');
      taskItem.className = 'task-item fade-in';
      taskItem.onclick = () => toggleTask(task.id);
      
      taskItem.innerHTML = `
        <div class="task-checkbox ${task.completed ? 'completed' : ''}">
          ${task.completed ? '✓' : ''}
        </div>
        <div class="task-content">
          <div class="task-title ${task.completed ? 'completed' : ''}">${task.title}</div>
          <div class="task-meta">
            <span>${task.description}</span>
            <span class="goal-priority priority-${task.priority}">
              ${task.priority === 'high' ? 'Aukštas' : task.priority === 'medium' ? 'Vidutinis' : 'Žemas'}
            </span>
          </div>
        </div>
      `;
      
      return taskItem;
    }

    function toggleTask(taskId) {
      const task = dailyTasks.find(t => t.id === taskId);
      if (task) {
        task.completed = !task.completed;
        renderTasks();
        updateTodayBanner();
        
        if (task.completed) {
          showNotification(`Užduotis įvykdyta: ${task.title} ✅`, 'success');
        }
      }
    }

    // =========================================================
    // IDEAS BOARD - SIMPLIFIED
    // =========================================================
    function renderIdeas() {
      const board = document.getElementById('ideasBoard');
      board.innerHTML = '';
      
      ideas.forEach(idea => {
        const ideaElement = document.createElement('div');
        ideaElement.className = 'idea-item';
        ideaElement.style.left = `${idea.x}px`;
        ideaElement.style.top = `${idea.y}px`;
        ideaElement.textContent = idea.text;
        ideaElement.draggable = true;
        
        ideaElement.addEventListener('dragstart', function(e) {
          e.dataTransfer.setData('text/plain', idea.id);
          this.classList.add('dragging');
        });
        
        ideaElement.addEventListener('dragend', function() {
          this.classList.remove('dragging');
        });
        
        board.appendChild(ideaElement);
      });
      
      board.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.classList.add('active');
      });
      
      board.addEventListener('dragleave', function() {
        this.classList.remove('active');
      });
      
      board.addEventListener('drop', function(e) {
        e.preventDefault();
        this.classList.remove('active');
        
        const ideaId = e.dataTransfer.getData('text/plain');
        const idea = ideas.find(i => i.id === ideaId);
        if (idea) {
          const rect = this.getBoundingClientRect();
          idea.x = e.clientX - rect.left - 100;
          idea.y = e.clientY - rect.top - 25;
          renderIdeas();
        }
      });
    }

    function addNewIdea() {
      const ideaText = prompt('Įveskite savo naują idėją:');
      if (ideaText && ideaText.trim()) {
        const newIdea = {
          id: `i_${Date.now()}`,
          text: ideaText.trim(),
          x: Math.random() * 300,
          y: Math.random() * 200
        };
        
        ideas.push(newIdea);
        renderIdeas();
        showNotification('Nauja idėja pridėta į lentą! 💡', 'success');
      }
    }

    // =========================================================
    // MODAL & NOTIFICATION SYSTEMS
    // =========================================================
    function showModal(title, content) {
      document.getElementById('modalTitle').innerHTML = title;
      document.getElementById('modalBody').innerHTML = content;
      document.getElementById('modalOverlay').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeModal() {
      document.getElementById('modalOverlay').classList.remove('active');
      document.body.style.overflow = '';
    }

    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification');
      notification.textContent = message;
      notification.className = `notification ${type} show`;
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 4000);
    }

    // =========================================================
    // GLOBAL FUNCTIONS FOR ONCLICK HANDLERS
    // =========================================================
    window.toggleTask = toggleTask;
    window.closeModal = closeModal;
    window.showNotification = showNotification;
    window.switchSection = switchSection;
    
    // New functions for photo-to-goal conversion
    window.convertPhotoToGoal = function(photoId, category) {
      closeModal();
      showNotification(`Konvertuojama "${category}" į tikslą! 🎯`, 'success');
      
      setTimeout(() => {
        const newGoal = {
          id: `g_photo_${Date.now()}`,
          title: `${category} - Tikslas`,
          description: `Automatiškai sugeneruotas tikslas iš vizijos nuotraukos`,
          icon: getCategoryIcon(category),
          progress: 0,
          priority: 'medium',
          deadline: '2025-12-31'
        };
        
        goals.push(newGoal);
        renderGoals();
        showNotification(`Naujas tikslas "${category}" pridėtas! 🎯`, 'success');
        
        setTimeout(() => {
          switchSection('goals');
        }, 1000);
      }, 1000);
    };
    
    window.generateTasksFromPhoto = function(photoId, category) {
      closeModal();
      showNotification(`Generuojamos užduotys kategorijai "${category}"! 📋`, 'info');
      
      setTimeout(() => {
        const categoryTasks = generateTasksForCategory(category);
        dailyTasks.push(...categoryTasks);
        renderTasks();
        updateTodayBanner();
        showNotification(`Sugeneruotos ${categoryTasks.length} užduotys kategorijai "${category}"! ✅`, 'success');
        
        setTimeout(() => {
          switchSection('daily');
        }, 1000);
      }, 1500);
    };
    
    // Helper functions
    function getCategoryIcon(category) {
      const categoryIcons = {
        'Finansai ir Verslas': '💰',
        'Šeima ir Santykiai': '👨‍👩‍👧‍👦',
        'Namai ir Gyvenimo Erdvė': '🏡',
        'Sveikata ir Sportas': '💪',
        'Kelionės ir Išgyvenimai': '✈️',
        'Technologijos ir Mokymasis': '🤖',
        'Hobiai ir Kūryba': '🎨',
        'Socialinis Poveikis': '🌍',
        'Karjera ir Profesija': '💼',
        'Automobilis ir Transportas': '🚗',
        'Menas ir Kultūra': '🎭',
        'Gamta ir Aplinka': '🌿',
        'Maistas ir Kulinarija': '🍳',
        'Draugai ir Bendravimas': '👥',
        'Asmeninė Laimė': '😊'
      };
      return categoryIcons[category] || '🎯';
    }
    
    function generateTasksForCategory(category) {
      const categoryTaskTemplates = {
        'Finansai ir Verslas': [
          { title: 'Suplanuoti mėnesio biudžetą', desc: 'Detalus pajamų ir išlaidų planas' },
          { title: 'Investicijų portfelio peržiūra', desc: 'Analizuoti dabartines investicijas' },
          { title: 'Verslo galimybių tyrimai', desc: 'Naujos rinkos analizė' }
        ],
        'Šeima ir Santykiai': [
          { title: 'Šeimos vakaras be telefonų', desc: 'Kokybiškas laikas su artimaisiais' },
          { title: 'Planuoti šeimos išvyką', desc: 'Savaitgalio veiklos organizavimas' },
          { title: 'Pokalbis su partneru', desc: 'Atvirų santykių stiprinimas' }
        ],
        'Sveikata ir Sportas': [
          { title: 'Rytinė sporto treniruotė', desc: '30 min fizinio aktyvumo' },
          { title: 'Sveikos mitybos planas', desc: 'Savaitės meniu sudarymas' },
          { title: 'Sveikatos patikrinimas', desc: 'Gydytojo vizitas profilaktikai' }
        ],
        'Namai ir Gyvenimo Erdvė': [
          { title: 'Namų tvarkymas ir organizavimas', desc: 'Erdvės optimizavimas' },
          { title: 'Namų ūkio pagerinimų planas', desc: 'Renovacijos idejų sąrašas' },
          { title: 'Interjero atnaujinimas', desc: 'Dekoracijos ir stilius' }
        ]
      };
      
      const templates = categoryTaskTemplates[category] || [
        { title: `${category} - veikla 1`, desc: 'Automatiškai sugeneruota užduotis' },
        { title: `${category} - veikla 2`, desc: 'Plėtojimo užduotis' }
      ];
      
      return templates.map((template, index) => ({
        id: `t_${category.replace(/\s+/g, '_').toLowerCase()}_${Date.now()}_${index}`,
        title: template.title,
        description: template.desc,
        completed: false,
        priority: Math.random() > 0.5 ? 'high' : 'medium'
      }));
    }

    console.log('🎯 ULTIMATE GOAL SYSTEM PAJUNGTA SU STABILIU JS!');
  </script>
  <script>
/* ====== AI GLUE: saugus prisikabinimas prie esamo UI (be perrašymų) ====== */
(function(){
  if (window.__AI_GLUE_INSTALLED__) return; 
  window.__AI_GLUE_INSTALLED__ = true;

  const MODEL_PREFS = ['gpt-5-mini','gpt-4o-mini','gpt-4o'];

  async function askAIStream(message){
    // 1) bandome srautą su pirmu modeliu
    try {
      const model = MODEL_PREFS[0];
      const url = `/api/stream?model=${encodeURIComponent(model)}&message=${encodeURIComponent(message)}&chat_id=${Date.now()}&max_tokens=1024`;
      const res = await fetch(url, { headers: { Accept: 'text/event-stream' }});
      if (!res.ok || !res.body) throw new Error('no stream');

      const reader = res.body.getReader();
      const dec = new TextDecoder();
      let buf = '', out = '';

      for(;;){
        const it = await reader.read();
        if (it.done) break;
        buf += dec.decode(it.value, {stream:true});
        let i;
        while ((i = buf.indexOf('\n\n')) >= 0){
          const frame = buf.slice(0, i).trim(); 
          buf = buf.slice(i+2);
          if (!frame) continue;
          const line = frame.split('\n').find(l => l.startsWith('data:'));
          if (!line) continue;
          const payload = line.replace(/^data:\s*/,'').trim();
          if (payload === '[DONE]') break;
          try {
            const j = JSON.parse(payload);
            const piece = j?.choices?.[0]?.delta?.content || '';
            if (piece) out += piece;
          } catch(_){}
        }
      }
      if (out.trim()) return out;
      throw new Error('empty');
    } catch(_){
      // 2) fallback į /api/complete su kelių modelių sąrašu
      const r = await fetch('/api/complete', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message, models: MODEL_PREFS.join(','), max_tokens: 1024 })
      });
      const j = await r.json().catch(()=>({}));
      const ok = (j.answers||[]).find(a => a && a.text && !a.error);
      return ok?.text || j.text || 'Nepavyko gauti atsakymo.';
    }
  }

  async function genFlux(prompt){
    const r = await fetch('/api/flux/create', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ prompt, width:1024, height:1024 })
    });
    const j = await r.json().catch(()=>({}));
    if (j?.image) return j.image;
    throw new Error(j?.error || 'FLUX klaida');
  }

  // Paimam tavo elementus, jei yra:
  const input   = document.querySelector('#messageInput, [data-ai-input]');
  const sendBtn = document.querySelector('#sendBtn, [data-ai-send]');
  const box     = document.querySelector('#chatMessages, [data-ai-messages]');

  function addMsg(html, who='ai'){
    if (typeof window.addChatMessage === 'function') {
      window.addChatMessage(html, who === 'user');
      return;
    }
    // Minimalus fallback jeigu nėra tavo addChatMessage()
    const wrap = document.createElement('div');
    wrap.style.cssText = 'margin:10px 0;padding:10px;border:1px solid #333;border-radius:8px;background:#111;color:#fff';
    wrap.innerHTML = `<div style="opacity:.7;margin-bottom:6px">${who==='user'?'👤':'🤖'}</div>${html}`;
    (box || document.body).appendChild(wrap);
    if (box) box.scrollTop = box.scrollHeight;
  }

  async function handleSend(){
    let msg = (input?.value || '').trim();
    if (!msg && !input) { msg = prompt('Klausimas AI:') || ''; }
    if (!msg) return;

    addMsg(msg, 'user');
    if (input){ input.value=''; input.style.height='auto'; }

    // Jeigu prašoma vaizdo – FLUX
    if (/foto|nuotrauk|paveiksl|image|flux/i.test(msg)) {
      try {
        const url = await genFlux(msg.replace(/^(foto|image|paveikslas)[: ]*/i,''));
        addMsg(`<img src="${url}" alt="AI image" style="max-width:100%;border-radius:12px">`, 'ai');
        return;
      } catch(e){ addMsg('⚠️ Vaizdo generavimo klaida: ' + (e?.message||e), 'ai'); return; }
    }

    try {
      const text = await askAIStream(msg);
      addMsg(text, 'ai');
    } catch(e){
      addMsg('⚠️ Klaida: ' + (e?.message||e), 'ai');
    }
  }

  // ——— Saugiai perimam mygtuką/Enter (neperrašant tavo funkcijų)
  if (sendBtn) {
    sendBtn.addEventListener('click', function(e){
      e.preventDefault(); e.stopImmediatePropagation();
      handleSend();
    }, { capture:true });
  }
  if (input) {
    input.addEventListener('keydown', function(e){
      if (e.key === 'Enter' && !e.shiftKey){
        e.preventDefault(); e.stopImmediatePropagation();
        handleSend();
      }
    }, { capture:true });
  }
  // Mini mygtukas, jei puslapyje nėra tavo chat UI
  if (!sendBtn && !input) {
    const btn = document.createElement('button');
    btn.textContent = '💬';
    btn.title = 'AI';
    btn.style.cssText = 'position:fixed;right:16px;bottom:16px;width:50px;height:50px;border:none;border-radius:50%;background:#4b7;color:#fff;font-size:20px;box-shadow:0 8px 26px rgba(0,0,0,.35);z-index:9999;cursor:pointer';
    btn.onclick = handleSend;
    document.body.appendChild(btn);
  }
})();
</script>

</body>
</html>
